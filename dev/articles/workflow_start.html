<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ISAnalytics">
<title>Setting up the workflow and first steps • ISAnalytics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Setting up the workflow and first steps">
<meta property="og:description" content="ISAnalytics">
<meta property="og:image" content="https://calabrialab.github.io/ISAnalytics/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ISAnalytics</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.7.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/ISAnalytics.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/workflow_start.html">Setting up the workflow and first steps</a>
    <a class="dropdown-item" href="../articles/sharing_analyses.html">Sharing analyses with ISAnalytics</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="https://calabrialab.github.io/ISAnalytics/">
    <span class="fas fa fas fa-code-branch"></span>
     
    RELEASE
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/calabrialab/ISAnalytics/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="workflow_start_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="workflow_start_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="workflow_start_files/datatables-binding-0.26/datatables.js"></script><link href="workflow_start_files/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="workflow_start_files/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="workflow_start_files/dt-core-1.12.1/js/jquery.dataTables.min.js"></script><link href="workflow_start_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="workflow_start_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Setting up the workflow and first steps</h1>
                        <h4 data-toc-skip class="author">Giulia
Pais</h4>
            <address class="author_afil">
      <p>San Raffaele Telethon Institute for Gene Therapy - SR-Tiget,
Via Olgettina 60, 20132 Milano -
Italia</p>
<br><a class="author_email" href="mailto:#"></a><a href="mailto:giuliapais1@gmail.com" class="email">giuliapais1@gmail.com</a>, <a href="mailto:calabria.andrea@hsr.it" class="email">calabria.andrea@hsr.it</a>
      </address>
                  
            <h4 data-toc-skip class="date">26 October 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/calabrialab/ISAnalytics/blob/HEAD/vignettes/workflow_start.Rmd" class="external-link"><code>vignettes/workflow_start.Rmd</code></a></small>
      <div class="d-none name"><code>workflow_start.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>ISAnalytics is an R package developed to analyze gene therapy vector
insertion sites data identified from genomics next generation sequencing
reads for clonal tracking studies.</p>
<p>In this vignette we will explain how to properly setup the workflow
and the first steps of data import and data cleaning.</p>
</div>
<div class="section level2">
<h2 id="installation-and-options">Installation and options<a class="anchor" aria-label="anchor" href="#installation-and-options"></a>
</h2>
<p><code>ISAnalytics</code> can be installed quickly in different
ways:</p>
<ul>
<li>You can install it via <a href="http://bioconductor.org" class="external-link">Bioconductor</a>
</li>
<li>You can install it via GitHub using the package
<code>devtools</code>
</li>
</ul>
<p>There are always 2 versions of the package active:</p>
<ul>
<li>
<code>RELEASE</code> is the latest stable version</li>
<li>
<code>DEVEL</code> is the development version, it is the most
up-to-date version where all new features are introduced</li>
</ul>
<div class="section level3">
<h3 id="installation-from-bioconductor">Installation from bioconductor<a class="anchor" aria-label="anchor" href="#installation-from-bioconductor"></a>
</h3>
<p>RELEASE version:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"ISAnalytics"</span><span class="op">)</span></span></code></pre></div>
<p>DEVEL version:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The following initializes usage of Bioc devel</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span>version<span class="op">=</span><span class="st">'devel'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"ISAnalytics"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="installation-from-github">Installation from GitHub<a class="anchor" aria-label="anchor" href="#installation-from-github"></a>
</h3>
<p>RELEASE:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"calabrialab/ISAnalytics"</span>,</span>
<span>                         ref <span class="op">=</span> <span class="st">"RELEASE_3_15"</span>,</span>
<span>                         dependencies <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>DEVEL:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"calabrialab/ISAnalytics"</span>,</span>
<span>                         ref <span class="op">=</span> <span class="st">"master"</span>,</span>
<span>                         dependencies <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="setting-options">Setting options<a class="anchor" aria-label="anchor" href="#setting-options"></a>
</h3>
<p><code>ISAnalytics</code> has a verbose option that allows some
functions to print additional information to the console while they’re
executing. To disable this feature do:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DISABLE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"ISAnalytics.verbose"</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ENABLE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"ISAnalytics.verbose"</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Some functions also produce report in a user-friendly HTML format, to
set this feature:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DISABLE HTML REPORTS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"ISAnalytics.reports"</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ENABLE HTML REPORTS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"ISAnalytics.reports"</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="setting-up-your-workflow-with-dynamic-vars">Setting up your workflow with dynamic vars<a class="anchor" aria-label="anchor" href="#setting-up-your-workflow-with-dynamic-vars"></a>
</h2>
<p>This section demonstrates how to properly setup your workflow with
<code>ISAnalytics</code> using the “dynamic vars” system.</p>
<p>From <code>ISAnalytics 1.5.4</code> onwards, a new system here
referred to as “dynamic vars” has been implemented to improve the
flexibility of the package, by allowing multiple input formats based on
user needs rather than enforcing hard-coded names and structures. In
this way, users that do not follow the standard name conventions used by
the package have to put minimal effort into making their inputs
compliant to the package requirements.</p>
<p>There are 5 main categories of inputs you can customize:</p>
<ul>
<li>The <strong>“mandatory IS vars”</strong>: this set of variables is
used to uniquely identify integration events across several functions
implemented in the package</li>
<li>The <strong>“annotation IS vars”</strong>: this set of variables
holds the names of the columns that contain genomic annotations</li>
<li>The <strong>“association file columns”</strong>: this set contains
information on how metadata is structured</li>
<li>The <strong>“VISPA2 stats specs”</strong>: this set contains
information on the format of pool statistics files produced
automatically by VISPA2</li>
<li>The <strong>“matrix files suffixes”</strong>: this set contains all
default file names for each quantification type and it is used by
automated import functions</li>
</ul>
<div class="section level3">
<h3 id="general-approach">General approach<a class="anchor" aria-label="anchor" href="#general-approach"></a>
</h3>
<p>The general approach is based on the specification of predefined tags
and their associated information in the form of simple data frames with
a standard structure, namely:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="12%">
<col width="32%">
<col width="12%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th>names</th>
<th>types</th>
<th>transform</th>
<th>flag</th>
<th>tag</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>&lt;name of the column&gt;</code></td>
<td><code>&lt;type&gt;</code></td>
<td><code>&lt;a lambda or NULL&gt;</code></td>
<td><code>&lt;flag&gt;</code></td>
<td><code>&lt;tag&gt;</code></td>
</tr></tbody>
</table>
<p>where</p>
<ul>
<li>
<code>names</code> contains the name of the column as a
character</li>
<li>
<code>types</code> contains the type of the column. Type should be
expressed as a string and should be in one of the allowed types
<ul>
<li>
<code>char</code> for character (strings)</li>
<li>
<code>int</code> for integers</li>
<li>
<code>logi</code> for logical values (TRUE / FALSE)</li>
<li>
<code>numeric</code> for numeric values</li>
<li>
<code>factor</code> for factors</li>
<li>
<code>date</code> for generic date format - note that functions that
need to read and parse files will try to guess the format and parsing
may fail</li>
<li>One of the accepted date/datetime formats by <em><a href="https://CRAN.R-project.org/package=lubridate" class="external-link">lubridate</a></em>,
you can use <code><a href="../reference/date_formats.html">ISAnalytics::date_formats()</a></code> to view the
accepted formats</li>
</ul>
</li>
<li>
<code>transform</code>: a purrr-style lambda that is applied
immediately after importing. This is useful to operate simple
transformations like removing unwanted characters or rounding to a
certain precision. Please note that these lambdas need to be functions
that accept a vector as input and only operate a <u>transformation</u>,
aka they output a vector of the same length as the input. For more
complicated applications that may require the value of other columns,
appropriate functions should be manually applied post-import.</li>
<li>
<code>flag</code>: as of now, it should be set either to
<code>required</code> or <code>optional</code> - some functions
internally check for only required tags presence and if those are
missing from inputs they fail, signaling failure to the user</li>
<li>
<code>tag</code>: a specific tag expressed as a string - see Section
@ref(tags)</li>
</ul>
<div class="figure">
<img src="../reference/figures/dyn_vars_general.png" alt=""><p class="caption">Dynamic variables general approach</p>
</div>
</div>
<div class="section level3">
<h3 id="tags">Tags<a class="anchor" aria-label="anchor" href="#tags"></a>
</h3>
<p>As already mentioned, certain functions included in the package
require the presence of specific tags (and associated column names) in
the input to work properly. You can always check what a tag means and
where it is used by using the function <code><a href="../reference/inspect_tags.html">inspect_tags()</a></code> and
providing in input the tags you want to check as a character vector.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect_tags.html">inspect_tags</a></span><span class="op">(</span><span class="st">"chromosome"</span><span class="op">)</span></span>
<span><span class="co">#&gt; * TAG: chromosome</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> Description: Number of the chromosome</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> Functions that use it: top_targeted_genes, CIS_grubbs, compute_near_integrations</span></span></code></pre></div>
<p>You should make sure the tag matches the right information in your
inputs by looking at the description of the tag. It is also possible to
add entries that are not associated with any tag. Here is an overview of
the critical tags for each category.</p>
<div class="section level4">
<h4 id="mandatory-is-vars">Mandatory IS vars<a class="anchor" aria-label="anchor" href="#mandatory-is-vars"></a>
</h4>
<div id="htmlwidget-22801886b847317619ab" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-22801886b847317619ab">{"x":{"filter":"none","vertical":false,"data":[["chromosome","locus","is_strand"],["top_targeted_genes, CIS_grubbs, compute_near_integrations","top_targeted_genes, CIS_grubbs, compute_near_integrations","CIS_grubbs, compute_near_integrations"],["Number of the chromosome","The locus at which the integration occurs","The DNA strand in which the integration occurs"]],"container":"<table class=\"stripe\">\n  <thead>\n    <tr>\n      <th>tag<\/th>\n      <th>needed_in<\/th>\n      <th>description<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>The presence of all mandatory IS vars is also checked and used in
other functions - for example, when importing matrices it is ensured
that all mandatory variables are present in the input, as declared in
the look up table. Some functions may require information that needs to
be specified as input, always check the documentation if you have
doubts.</p>
</div>
<div class="section level4">
<h4 id="annotation-is-vars">Annotation IS vars<a class="anchor" aria-label="anchor" href="#annotation-is-vars"></a>
</h4>
<div id="htmlwidget-641c164ca42bbf714a9f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-641c164ca42bbf714a9f">{"x":{"filter":"none","vertical":false,"data":[["gene_symbol","gene_strand"],["top_targeted_genes, CIS_grubbs, compute_near_integrations, CIS_volcano_plot","top_targeted_genes, CIS_grubbs"],["The symbol of the gene","The strand of the gene"]],"container":"<table class=\"stripe\">\n  <thead>\n    <tr>\n      <th>tag<\/th>\n      <th>needed_in<\/th>\n      <th>description<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Although genomic annotations are not necessarily required to work
with ISAnalytics, some operations do require annotation - if you’re
working with matrices that are not annotated you can either annotate
them with a tool of your choice or skip the steps that require
annotation.</p>
</div>
<div class="section level4">
<h4 id="association-file-columns">Association file columns<a class="anchor" aria-label="anchor" href="#association-file-columns"></a>
</h4>
<div id="htmlwidget-47de66f956e5f28a744a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-47de66f956e5f28a744a">{"x":{"filter":"none","vertical":false,"data":[["project_id","pool_id","fusion_id","tag_seq","subject","vector_id","tissue","tp_days","pcr_method","cell_marker","tag_id","ngs_tech","dna_num","pcr_replicate","vcn","vispa_concatenate","pcr_repl_id","proj_folder","genome"],["generate_default_folder_structure, import_Vispa2_stats, remove_collisions, generate_Vispa2_launch_AF, import_association_file, import_parallel_Vispa2Matrices","generate_Vispa2_launch_AF, remove_collisions, import_association_file","generate_Vispa2_launch_AF","generate_default_folder_structure, import_association_file, import_Vispa2_stats","import_association_file, HSC_population_size_estimate","generate_Vispa2_launch_AF","generate_Vispa2_launch_AF, import_association_file, HSC_population_size_estimate","generate_Vispa2_launch_AF, import_association_file","","generate_Vispa2_launch_AF, import_association_file, HSC_population_size_estimate","generate_Vispa2_launch_AF","","","import_association_file, remove_collisions","","import_association_file, generate_Vispa2_launch_AF, generate_default_folder_structure, import_Vispa2_stats, import_parallel_Vispa2Matrices","pcr_id_column, generate_Vispa2_launch_AF, import_association_file, import_Vispa2_stats","import_association_file",""],["Unique identifier of a project","Unique identifier of a sequencing pool","Identification code/number of the barcoded (SLiM-)PCR product included in the sequencing library","The barcode tag sequence","Unique identifier of a study subject (usually a patient)","Unique identifier of the vector used","The biological tissue the sample belongs to","The time point expressed in days","The PCR method used","Cell marker associated with isolated cells carrying the IS","Unique identifier of the barcode tag, as specified in VISPA2 requirements","Technology used for next generation sequencing","Identification code/number of the DNA extraction from a specific biological sample","Number of the PCR replicate","Vector copy number","Unique identifier of a pool as specified in VISPA2","Unique identifier of the pcr replicate, used as key to join data and metadata","Path on disk containing the standard VISPA2 folder structure of the project","The reference genome (e.g. 'hg19')"]],"container":"<table class=\"stripe\">\n  <thead>\n    <tr>\n      <th>tag<\/th>\n      <th>needed_in<\/th>\n      <th>description<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>Some tags in this table are not associated with any function yet, but
they exist for potential new features that will be added in the
future.</p>
</div>
<div class="section level4">
<h4 id="vispa2-stats-specs">VISPA2 stats specs<a class="anchor" aria-label="anchor" href="#vispa2-stats-specs"></a>
</h4>
<div id="htmlwidget-dc8e2d6533fb0da0a86c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-dc8e2d6533fb0da0a86c">{"x":{"filter":"none","vertical":false,"data":[["vispa_concatenate","tag_seq"],["import_association_file, generate_Vispa2_launch_AF, generate_default_folder_structure, import_Vispa2_stats, import_parallel_Vispa2Matrices","generate_default_folder_structure, import_association_file, import_Vispa2_stats"],["Unique identifier of a pool as specified in VISPA2","The barcode tag sequence"]],"container":"<table class=\"stripe\">\n  <thead>\n    <tr>\n      <th>tag<\/th>\n      <th>needed_in<\/th>\n      <th>description<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>NOTE: VISPA2 stats files usually follow standard naming conventions.
If the pipeline launch was configured with default parameters, do not
change this lookup table.</p>
</div>
</div>
<div class="section level3">
<h3 id="customizing-dynamic-vars">Customizing dynamic vars<a class="anchor" aria-label="anchor" href="#customizing-dynamic-vars"></a>
</h3>
<p>For each category of dynamic vars there are 3 functions:</p>
<ul>
<li>A getter - returns the current lookup table</li>
<li>A setter - allows the user to change the current lookup table</li>
<li>A resetter - reverts all changes to defaults</li>
</ul>
<p>Setters will take in input the new variables, validate and eventually
change the lookup table. If validation fails an error will be thrown
instead, inviting the user to review the inputs. Moreover, if some of
the critical tags for the category are missing, a warning appears, with
a list of the missing ones.</p>
<p>Let’s take a look at some examples.</p>
<p>On package loading, all lookup tables are set to default values. For
example, for mandatory IS vars we have:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mandatory_IS_vars.html">mandatory_IS_vars</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   names             types transform flag     tag       </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> chr               char  <span style="color: #949494;">&lt;NULL&gt;</span>    required chromosome</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> integration_locus int   <span style="color: #949494;">&lt;NULL&gt;</span>    required locus     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> strand            char  <span style="color: #949494;">&lt;NULL&gt;</span>    required is_strand</span></span></code></pre></div>
<p>Let’s suppose our matrices follow a different standard, and
integration events are characterized by 5 fields, like so (the example
contains random data):</p>
<table class="table">
<thead><tr class="header">
<th>chrom</th>
<th>position</th>
<th>strand</th>
<th>gap</th>
<th>junction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>“chr1”</td>
<td>342543</td>
<td>“+”</td>
<td>100</td>
<td>50</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>To make this work with ISAnalytics functions, we need to compile the
lookup table like this:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_mand_vars</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">names</span>, <span class="op">~</span><span class="va">types</span>, <span class="op">~</span><span class="va">transform</span>, <span class="op">~</span><span class="va">flag</span>, <span class="op">~</span><span class="va">tag</span>,</span>
<span>  <span class="st">"chrom"</span>, <span class="st">"char"</span>, <span class="op">~</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span><span class="va">.x</span>, <span class="st">"chr"</span>, <span class="st">""</span><span class="op">)</span>, <span class="st">"required"</span>,</span>
<span>  <span class="st">"chromosome"</span>,</span>
<span>  <span class="st">"position"</span>, <span class="st">"int"</span>, <span class="cn">NULL</span>, <span class="st">"required"</span>, <span class="st">"locus"</span>,</span>
<span>  <span class="st">"strand"</span>, <span class="st">"char"</span>, <span class="cn">NULL</span>, <span class="st">"required"</span>, <span class="st">"is_strand"</span>,</span>
<span>  <span class="st">"gap"</span>, <span class="st">"int"</span>, <span class="cn">NULL</span>, <span class="st">"required"</span>, <span class="cn">NA_character_</span>,</span>
<span>  <span class="st">"junction"</span>, <span class="st">"int"</span>, <span class="cn">NULL</span>, <span class="st">"required"</span>, <span class="cn">NA_character_</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Notice that we have specified a transformation for the “chromosome”
tag: in this case we would like to have only the number of the
chromosome without the prefix “chr” - this lambda will get executed
immediately after import.</p>
<p>To set the new variables simply do:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_mandatory_IS_vars.html">set_mandatory_IS_vars</a></span><span class="op">(</span><span class="va">new_mand_vars</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mandatory IS vars successfully changed</span></span>
<span><span class="fu"><a href="../reference/mandatory_IS_vars.html">mandatory_IS_vars</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 5</span></span></span>
<span><span class="co">#&gt;   names    types transform flag     tag       </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> chrom    char  <span style="color: #949494;">&lt;formula&gt;</span> required chromosome</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> position int   <span style="color: #949494;">&lt;NULL&gt;</span>    required locus     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> strand   char  <span style="color: #949494;">&lt;NULL&gt;</span>    required is_strand </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> gap      int   <span style="color: #949494;">&lt;NULL&gt;</span>    required <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> junction int   <span style="color: #949494;">&lt;NULL&gt;</span>    required <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>If you don’t specify a critical tag, a warning message is
displayed:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_mand_vars</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">$</span><span class="va">tag</span> <span class="op">&lt;-</span> <span class="cn">NA_character_</span></span>
<span><span class="fu"><a href="../reference/set_mandatory_IS_vars.html">set_mandatory_IS_vars</a></span><span class="op">(</span><span class="va">new_mand_vars</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Warning: important tags missing</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> Some tags are required for proper execution of some functions. If these tags are not provided, execution of dependent functions might fail. Review your inputs carefully.</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> Missing tags: chromosome</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> To see where these are involved type `inspect_tags(c('chromosome'))`</span></span>
<span><span class="co">#&gt; Mandatory IS vars successfully changed</span></span>
<span><span class="fu"><a href="../reference/mandatory_IS_vars.html">mandatory_IS_vars</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 5</span></span></span>
<span><span class="co">#&gt;   names    types transform flag     tag      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> chrom    char  <span style="color: #949494;">&lt;formula&gt;</span> required <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> position int   <span style="color: #949494;">&lt;NULL&gt;</span>    required locus    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> strand   char  <span style="color: #949494;">&lt;NULL&gt;</span>    required is_strand</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> gap      int   <span style="color: #949494;">&lt;NULL&gt;</span>    required <span style="color: #BB0000;">NA</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> junction int   <span style="color: #949494;">&lt;NULL&gt;</span>    required <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>If you change your mind and want to go back to defaults:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/reset_mandatory_IS_vars.html">reset_mandatory_IS_vars</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mandatory IS vars reset to default</span></span>
<span><span class="fu"><a href="../reference/mandatory_IS_vars.html">mandatory_IS_vars</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   names             types transform flag     tag       </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> chr               char  <span style="color: #949494;">&lt;NULL&gt;</span>    required chromosome</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> integration_locus int   <span style="color: #949494;">&lt;NULL&gt;</span>    required locus     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> strand            char  <span style="color: #949494;">&lt;NULL&gt;</span>    required is_strand</span></span></code></pre></div>
<p>The principle is the same for annotation IS vars, association file
columns and VISPA2 stats specs. Here is a summary of the functions for
each:</p>
<ul>
<li>mandatory IS vars: <code><a href="../reference/mandatory_IS_vars.html">mandatory_IS_vars()</a></code>,
<code><a href="../reference/set_mandatory_IS_vars.html">set_mandatory_IS_vars()</a></code>,
<code><a href="../reference/reset_mandatory_IS_vars.html">reset_mandatory_IS_vars()</a></code>
</li>
<li>annotation IS vars: <code><a href="../reference/mandatory_IS_vars.html">annotation_IS_vars()</a></code>,
<code><a href="../reference/set_mandatory_IS_vars.html">set_annotation_IS_vars()</a></code>,
<code><a href="../reference/reset_mandatory_IS_vars.html">reset_annotation_IS_vars()</a></code>
</li>
<li>association file columns: <code><a href="../reference/mandatory_IS_vars.html">association_file_columns()</a></code>,
<code><a href="../reference/set_mandatory_IS_vars.html">set_af_columns_def()</a></code>,
<code><a href="../reference/reset_mandatory_IS_vars.html">reset_af_columns_def()</a></code>
</li>
<li>VISPA2 stats specs: <code><a href="../reference/mandatory_IS_vars.html">iss_stats_specs()</a></code>,
<code><a href="../reference/set_mandatory_IS_vars.html">set_iss_stats_specs()</a></code>,
<code>reset_iss_stats_specs</code>
</li>
</ul>
<p>Matrix files suffixes work slightly different:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mandatory_IS_vars.html">matrix_file_suffixes</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">#&gt;    quantification   matrix_type   file_suffix                                 </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;glue&gt;</span>                                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> seqCount         annotated     seqCount_matrix.no0.annotated.tsv.gz        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> fragmentEstimate annotated     fragmentEstimate_matrix.no0.annotated.tsv.gz</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> barcodeCount     annotated     barcodeCount_matrix.no0.annotated.tsv.gz    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> cellCount        annotated     cellCount_matrix.no0.annotated.tsv.gz       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> ShsCount         annotated     ShsCount_matrix.no0.annotated.tsv.gz        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> seqCount         not_annotated seqCount_matrix.tsv.gz                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> fragmentEstimate not_annotated fragmentEstimate_matrix.tsv.gz              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> barcodeCount     not_annotated barcodeCount_matrix.tsv.gz                  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> cellCount        not_annotated cellCount_matrix.tsv.gz                     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> ShsCount         not_annotated ShsCount_matrix.tsv.gz</span></span></code></pre></div>
<p>To change this lookup table use the function
<code><a href="../reference/set_matrix_file_suffixes.html">set_matrix_file_suffixes()</a></code>: the function will ask to
specify a suffix for each quantification and for both annotated and not
annotated versions. These suffixes are used in the automated matrix
import function when scanning the file system.</p>
<p>To reset all lookup tables to their default configurations you can
also use the function <code><a href="../reference/reset_mandatory_IS_vars.html">reset_dyn_vars_config()</a></code>, which
reverts all changes.</p>
</div>
<div class="section level3">
<h3 id="faqs">FAQs<a class="anchor" aria-label="anchor" href="#faqs"></a>
</h3>
<div class="section level4">
<h4 id="do-i-have-to-do-this-every-time-the-package-loads">Do I have to do this every time the package loads?<a class="anchor" aria-label="anchor" href="#do-i-have-to-do-this-every-time-the-package-loads"></a>
</h4>
<p>No, if you frequently have to work with a non-standard settings
profile, you can use the functions <code><a href="../reference/export_ISA_settings.html">export_ISA_settings()</a></code>
and <code><a href="../reference/import_ISA_settings.html">import_ISA_settings()</a></code>: these functions allow the
import/export of setting profiles in *.json format.</p>
<p>Once you set your variables for the first time through the procedure
described before, simply call the export function and all will be saved
to a json file, which can then be imported for the next workflow.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="reporting-progress">Reporting progress<a class="anchor" aria-label="anchor" href="#reporting-progress"></a>
</h2>
<p>From <code>ISAnalytics 1.7.4</code>, functions that make use of
parallel workers or process long tasks report progress via the functions
offered by <a href="https://progressr.futureverse.org/" class="external-link">progressr</a>.
To enable progress bars for all functions in ISAnalytics do</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/enable_progress_bars.html">enable_progress_bars</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>before calling other functions. For customizing the appearance of the
progress bar please refer to <code>progressr</code> documentation.</p>
</div>
<div class="section level2">
<h2 id="introduction-to-isanalytics-import-functions-family">Introduction to <code>ISAnalytics</code> import functions
family<a class="anchor" aria-label="anchor" href="#introduction-to-isanalytics-import-functions-family"></a>
</h2>
<p>In this section we’re going to explain more in detail how functions
of the import family should be used, the most common workflows to follow
and more.</p>
<div class="section level3">
<h3 id="designed-to-work-with-vispa2-pipeline">Designed to work with VISPA2 pipeline<a class="anchor" aria-label="anchor" href="#designed-to-work-with-vispa2-pipeline"></a>
</h3>
<p>The vast majority of the functions included in this package is
designed to work in combination with VISPA2 pipeline (Giulio Spinozzi
Andrea Calabria, 2017). If you don’t know what it is, we strongly
recommend you to take a look at these links:</p>
<ul>
<li>Article: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5702242/" class="external-link">VISPA2:
Article</a><br>
</li>
<li>BitBucket Wiki: <a href="https://bitbucket.org/andreacalabria/vispa2/wiki/Home" class="external-link">VISPA2
Wiki</a>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="file-system-structure-generated">File system structure generated<a class="anchor" aria-label="anchor" href="#file-system-structure-generated"></a>
</h3>
<p>VISPA2 produces a standard file system structure starting from a
folder you specify as your workbench or root. The structure always
follows this schema:</p>
<ul>
<li>root/
<ul>
<li>Optional intermediate folders
<ul>
<li>Projects (PROJECTID)
<ul>
<li>bam</li>
<li>bcmuxall</li>
<li>bed</li>
<li>iss
<ul>
<li>Pools (concatenatePoolIDSeqRun)</li>
</ul>
</li>
<li>quality</li>
<li>quantification
<ul>
<li>Pools (concatenatePoolIDSeqRun)</li>
</ul>
</li>
<li>report</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Most of the functions implemented expect a standard file system
structure as the one described above.</p>
</div>
<div class="section level3">
<h3 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h3>
<p>We call an <em>“integration matrix”</em> a tabular structure
characterized by:</p>
<ul>
<li>k mandatory columns of genomic features that characterize a viral
insertion site in the genome, which are specified via
<code><a href="../reference/mandatory_IS_vars.html">mandatory_IS_vars()</a></code>. By default they’re set to
<code>chr</code>, <code>integration_locus</code> and
<code>strand</code>
</li>
<li>a (optional) annotation columns, provided via
<code><a href="../reference/mandatory_IS_vars.html">annotation_IS_vars()</a></code>. By default they’re set to
<code>GeneName</code> and <code>GeneStrand</code>
</li>
<li>A variable number n of sample columns containing the quantification
of the corresponding integration site</li>
</ul>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 8</span></span></span>
<span><span class="co">#&gt;   chr   integration_locus strand GeneName     GeneStrand  exp1  exp2  exp3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1                 <span style="text-decoration: underline;">12</span>324 +      NFATC3       +           <span style="text-decoration: underline;">4</span>553  <span style="text-decoration: underline;">5</span>345    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 6                <span style="text-decoration: underline;">657</span>532 +      LOC100507487 +             76   545     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 7                <span style="text-decoration: underline;">657</span>532 +      EDIL3        -             <span style="color: #BB0000;">NA</span>    56    <span style="color: #BB0000;">NA</span></span></span></code></pre>
<p>The package uses a more compact form of these matrices, limiting the
amount of NA values and optimizing time and memory consumption. For more
info on this take a look at: <a href="https://r4ds.had.co.nz/tidy-data.html" class="external-link">Tidy data</a></p>
<p>While integration matrices contain the actual data, we also need
associated sample metadata to perform the vast majority of the analyses.
<code>ISAnalytics</code> expects the metadata to be contained in a so
called <em>“association file”</em>, which is a simple tabular file.</p>
<p>To generate a blank association file you can use the function
<code>generate_blank_association_file</code>. You can also view the
standard column names with <code><a href="../reference/mandatory_IS_vars.html">association_file_columns()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="metadata">Importing metadata<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h3>
<p>To import metadata we use <code><a href="../reference/import_association_file.html">import_association_file()</a></code>.
This function is not only responsible for reading the file into the R
environment as a data frame, but it is capable to perform a file system
alignment operation, that is, for each project and pool contained in the
file, it scans the file system starting from the provided root to check
if the corresponding folders (contained in the appropriate column) can
be found. Remember that to work properly, this operation expects a
standard folder structure, such as the one provided by VISPA2. This
function also produces an interactive HTML report.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fs_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_default_folder_structure.html">generate_default_folder_structure</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_options.html" class="external-link">with_options</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ISAnalytics.reports <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, code <span class="op">=</span> <span class="op">{</span></span>
<span>  <span class="va">af</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_association_file.html">import_association_file</a></span><span class="op">(</span><span class="va">fs_path</span><span class="op">$</span><span class="va">af</span>, root <span class="op">=</span> <span class="va">fs_path</span><span class="op">$</span><span class="va">root</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; *** Association file import summary ***</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">ℹ</span> For detailed report please set option 'ISAnalytics.reports' to TRUE</span></span>
<span><span class="co">#&gt; Parsing problems detected: FALSE</span></span>
<span><span class="co">#&gt; Date parsing problems: FALSE</span></span>
<span><span class="co">#&gt; Column problems detected: FALSE</span></span>
<span><span class="co">#&gt; NAs found in important columns: FALSE</span></span>
<span><span class="co">#&gt; File system alignment: no problems detected</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;    ProjectID  FUSIONID PoolID TagSequence SubjectID VectorType VectorID</span></span>
<span><span class="co">#&gt; 1:      PJ01 ET#382.46 POOL01   LTR75LC38     PT001      lenti    GLOBE</span></span>
<span><span class="co">#&gt; 2:      PJ01 ET#381.40 POOL01   LTR53LC32     PT001      lenti    GLOBE</span></span>
<span><span class="co">#&gt; 3:      PJ01  ET#381.9 POOL01   LTR83LC66     PT001      lenti    GLOBE</span></span>
<span><span class="co">#&gt; 4:      PJ01 ET#381.71 POOL01   LTR27LC94     PT001      lenti    GLOBE</span></span>
<span><span class="co">#&gt; 5:      PJ01  ET#381.2 POOL01   LTR69LC52     PT001      lenti    GLOBE</span></span>
<span><span class="co">#&gt; 6:      PJ01 ET#382.28 POOL01    LTR37LC2     PT001      lenti    GLOBE</span></span>
<span><span class="co">#&gt;    ExperimentID Tissue TimePoint DNAFragmentation PCRMethod TagIDextended</span></span>
<span><span class="co">#&gt; 1:         &lt;NA&gt;     PB      0060            SONIC      SLiM     LTR75LC38</span></span>
<span><span class="co">#&gt; 2:         &lt;NA&gt;     BM      0180            SONIC      SLiM     LTR53LC32</span></span>
<span><span class="co">#&gt; 3:         &lt;NA&gt;     BM      0180            SONIC      SLiM     LTR83LC66</span></span>
<span><span class="co">#&gt; 4:         &lt;NA&gt;     BM      0180            SONIC      SLiM     LTR27LC94</span></span>
<span><span class="co">#&gt; 5:         &lt;NA&gt;     PB      0180            SONIC      SLiM     LTR69LC52</span></span>
<span><span class="co">#&gt; 6:         &lt;NA&gt;     BM      0060            SONIC      SLiM      LTR37LC2</span></span>
<span><span class="co">#&gt;    Keywords CellMarker      TagID NGSProvider NGSTechnology ConverrtedFilesDir</span></span>
<span><span class="co">#&gt; 1:     &lt;NA&gt;        MNC LTR75.LC38        &lt;NA&gt;         HiSeq               &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2:     &lt;NA&gt;        MNC LTR53.LC32        &lt;NA&gt;         HiSeq               &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3:     &lt;NA&gt;        MNC LTR83.LC66        &lt;NA&gt;         HiSeq               &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4:     &lt;NA&gt;        MNC LTR27.LC94        &lt;NA&gt;         HiSeq               &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5:     &lt;NA&gt;        MNC LTR69.LC52        &lt;NA&gt;         HiSeq               &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6:     &lt;NA&gt;        MNC  LTR37.LC2        &lt;NA&gt;         HiSeq               &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    ConverrtedFilesName SourceFileFolder SourceFileNameR1 SourceFileNameR2</span></span>
<span><span class="co">#&gt; 1:                &lt;NA&gt;             &lt;NA&gt;             &lt;NA&gt;             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2:                &lt;NA&gt;             &lt;NA&gt;             &lt;NA&gt;             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3:                &lt;NA&gt;             &lt;NA&gt;             &lt;NA&gt;             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4:                &lt;NA&gt;             &lt;NA&gt;             &lt;NA&gt;             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5:                &lt;NA&gt;             &lt;NA&gt;             &lt;NA&gt;             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6:                &lt;NA&gt;             &lt;NA&gt;             &lt;NA&gt;             &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    DNAnumber ReplicateNumber DNAextractionDate DNAngUsed LinearPCRID</span></span>
<span><span class="co">#&gt; 1: PT001-103               3        2016-03-16    23.184        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2:  PT001-81               2        2016-07-15   181.440        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3:  PT001-81               1        2016-07-15   181.440        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4:  PT001-81               3        2016-07-15   181.440        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5:  PT001-74               1        2016-07-15    23.058        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6: PT001-107               2        2016-03-16   171.360        &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    LinearPCRDate SonicationDate LigationDate 1stExpoPCRID 1stExpoPCRDate</span></span>
<span><span class="co">#&gt; 1:          &lt;NA&gt;     2016-11-02   2016-11-02    ET#380.46     2016-11-02</span></span>
<span><span class="co">#&gt; 2:          &lt;NA&gt;     2016-11-02   2016-11-02    ET#379.40     2016-11-02</span></span>
<span><span class="co">#&gt; 3:          &lt;NA&gt;     2016-11-02   2016-11-02     ET#379.9     2016-11-02</span></span>
<span><span class="co">#&gt; 4:          &lt;NA&gt;     2016-11-02   2016-11-02    ET#379.71     2016-11-02</span></span>
<span><span class="co">#&gt; 5:          &lt;NA&gt;     2016-11-02   2016-11-02     ET#379.2     2016-11-02</span></span>
<span><span class="co">#&gt; 6:          &lt;NA&gt;     2016-11-02   2016-11-02    ET#380.28     2016-11-02</span></span>
<span><span class="co">#&gt;    2ndExpoID 2ndExpoDate FusionPrimerPCRID FusionPrimerPCRDate   PoolDate</span></span>
<span><span class="co">#&gt; 1:      &lt;NA&gt;        &lt;NA&gt;         ET#382.46          2016-11-03 2016-11-07</span></span>
<span><span class="co">#&gt; 2:      &lt;NA&gt;        &lt;NA&gt;         ET#381.40          2016-11-03 2016-11-07</span></span>
<span><span class="co">#&gt; 3:      &lt;NA&gt;        &lt;NA&gt;          ET#381.9          2016-11-03 2016-11-07</span></span>
<span><span class="co">#&gt; 4:      &lt;NA&gt;        &lt;NA&gt;         ET#381.71          2016-11-03 2016-11-07</span></span>
<span><span class="co">#&gt; 5:      &lt;NA&gt;        &lt;NA&gt;          ET#381.2          2016-11-03 2016-11-07</span></span>
<span><span class="co">#&gt; 6:      &lt;NA&gt;        &lt;NA&gt;         ET#382.28          2016-11-03 2016-11-07</span></span>
<span><span class="co">#&gt;    SequencingDate  VCN Genome SequencingRound Genotype TestGroup  MOI</span></span>
<span><span class="co">#&gt; 1:     2016-11-15 0.30   hg19               1     &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2:     2016-11-15 0.27   hg19               1     &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3:     2016-11-15 0.27   hg19               1     &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4:     2016-11-15 0.27   hg19               1     &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5:     2016-11-15 0.24   hg19               1     &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6:     2016-11-15 0.42   hg19               1     &lt;NA&gt;      &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    Engraftment Transduction Notes AddedField1 AddedField2 AddedField3</span></span>
<span><span class="co">#&gt; 1:          NA           NA  &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2:          NA           NA  &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3:          NA           NA  &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4:          NA           NA  &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5:          NA           NA  &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6:          NA           NA  &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;        &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    AddedField4 concatenatePoolIDSeqRun AddedField6_RelativeBloodPercentage</span></span>
<span><span class="co">#&gt; 1:        &lt;NA&gt;                POOL01-1                                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2:        &lt;NA&gt;                POOL01-1                                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3:        &lt;NA&gt;                POOL01-1                                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4:        &lt;NA&gt;                POOL01-1                                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5:        &lt;NA&gt;                POOL01-1                                &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6:        &lt;NA&gt;                POOL01-1                                &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    AddedField7_PurityTestFeasibility AddedField8_FacsSeparationPurity Kapa</span></span>
<span><span class="co">#&gt; 1:                              &lt;NA&gt;                             &lt;NA&gt;   NA</span></span>
<span><span class="co">#&gt; 2:                              &lt;NA&gt;                             &lt;NA&gt;   NA</span></span>
<span><span class="co">#&gt; 3:                              &lt;NA&gt;                             &lt;NA&gt;   NA</span></span>
<span><span class="co">#&gt; 4:                              &lt;NA&gt;                             &lt;NA&gt;   NA</span></span>
<span><span class="co">#&gt; 5:                              &lt;NA&gt;                             &lt;NA&gt;   NA</span></span>
<span><span class="co">#&gt; 6:                              &lt;NA&gt;                             &lt;NA&gt;   NA</span></span>
<span><span class="co">#&gt;    ulForPool</span></span>
<span><span class="co">#&gt; 1:        NA</span></span>
<span><span class="co">#&gt; 2:        NA</span></span>
<span><span class="co">#&gt; 3:        NA</span></span>
<span><span class="co">#&gt; 4:        NA</span></span>
<span><span class="co">#&gt; 5:        NA</span></span>
<span><span class="co">#&gt; 6:        NA</span></span>
<span><span class="co">#&gt;                                                 CompleteAmplificationID</span></span>
<span><span class="co">#&gt; 1: PJ01_POOL01_LTR75LC38_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC</span></span>
<span><span class="co">#&gt; 2:  PJ01_POOL01_LTR53LC32_PT001_PT001-81_lenti_GLOBE_BM_1_SLiM_0180_MNC</span></span>
<span><span class="co">#&gt; 3:  PJ01_POOL01_LTR83LC66_PT001_PT001-81_lenti_GLOBE_BM_1_SLiM_0180_MNC</span></span>
<span><span class="co">#&gt; 4:  PJ01_POOL01_LTR27LC94_PT001_PT001-81_lenti_GLOBE_BM_1_SLiM_0180_MNC</span></span>
<span><span class="co">#&gt; 5:  PJ01_POOL01_LTR69LC52_PT001_PT001-74_lenti_GLOBE_PB_1_SLiM_0180_MNC</span></span>
<span><span class="co">#&gt; 6:  PJ01_POOL01_LTR37LC2_PT001_PT001-107_lenti_GLOBE_BM_1_SLiM_0060_MNC</span></span>
<span><span class="co">#&gt;                  UniqueID StudyTestID StudyTestGroup MouseID Tigroup Tisource</span></span>
<span><span class="co">#&gt; 1: ID00000000000000007433        &lt;NA&gt;           &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2: ID00000000000000007340        &lt;NA&gt;           &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3: ID00000000000000007310        &lt;NA&gt;           &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4: ID00000000000000007370        &lt;NA&gt;           &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5: ID00000000000000007303        &lt;NA&gt;           &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6: ID00000000000000007417        &lt;NA&gt;           &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">#&gt;    PathToFolderProjectID SamplesNameCheck TimepointDays TimepointMonths</span></span>
<span><span class="co">#&gt; 1:                 /PJ01             &lt;NA&gt;          0060              02</span></span>
<span><span class="co">#&gt; 2:                 /PJ01             &lt;NA&gt;          0180              06</span></span>
<span><span class="co">#&gt; 3:                 /PJ01             &lt;NA&gt;          0180              06</span></span>
<span><span class="co">#&gt; 4:                 /PJ01             &lt;NA&gt;          0180              06</span></span>
<span><span class="co">#&gt; 5:                 /PJ01             &lt;NA&gt;          0180              06</span></span>
<span><span class="co">#&gt; 6:                 /PJ01             &lt;NA&gt;          0060              02</span></span>
<span><span class="co">#&gt;    TimepointYears ng DNA corrected                    Path</span></span>
<span><span class="co">#&gt; 1:             01            23.18 /tmp/Rtmp9cd12E/fs/PJ01</span></span>
<span><span class="co">#&gt; 2:             01           181.44 /tmp/Rtmp9cd12E/fs/PJ01</span></span>
<span><span class="co">#&gt; 3:             01           181.44 /tmp/Rtmp9cd12E/fs/PJ01</span></span>
<span><span class="co">#&gt; 4:             01           181.44 /tmp/Rtmp9cd12E/fs/PJ01</span></span>
<span><span class="co">#&gt; 5:             01            23.06 /tmp/Rtmp9cd12E/fs/PJ01</span></span>
<span><span class="co">#&gt; 6:             01           171.36 /tmp/Rtmp9cd12E/fs/PJ01</span></span>
<span><span class="co">#&gt;                                         Path_quant</span></span>
<span><span class="co">#&gt; 1: /tmp/Rtmp9cd12E/fs/PJ01/quantification/POOL01-1</span></span>
<span><span class="co">#&gt; 2: /tmp/Rtmp9cd12E/fs/PJ01/quantification/POOL01-1</span></span>
<span><span class="co">#&gt; 3: /tmp/Rtmp9cd12E/fs/PJ01/quantification/POOL01-1</span></span>
<span><span class="co">#&gt; 4: /tmp/Rtmp9cd12E/fs/PJ01/quantification/POOL01-1</span></span>
<span><span class="co">#&gt; 5: /tmp/Rtmp9cd12E/fs/PJ01/quantification/POOL01-1</span></span>
<span><span class="co">#&gt; 6: /tmp/Rtmp9cd12E/fs/PJ01/quantification/POOL01-1</span></span>
<span><span class="co">#&gt;                                Path_iss</span></span>
<span><span class="co">#&gt; 1: /tmp/Rtmp9cd12E/fs/PJ01/iss/POOL01-1</span></span>
<span><span class="co">#&gt; 2: /tmp/Rtmp9cd12E/fs/PJ01/iss/POOL01-1</span></span>
<span><span class="co">#&gt; 3: /tmp/Rtmp9cd12E/fs/PJ01/iss/POOL01-1</span></span>
<span><span class="co">#&gt; 4: /tmp/Rtmp9cd12E/fs/PJ01/iss/POOL01-1</span></span>
<span><span class="co">#&gt; 5: /tmp/Rtmp9cd12E/fs/PJ01/iss/POOL01-1</span></span>
<span><span class="co">#&gt; 6: /tmp/Rtmp9cd12E/fs/PJ01/iss/POOL01-1</span></span></code></pre>
<div class="section level4">
<h4 id="function-arguments">Function arguments<a class="anchor" aria-label="anchor" href="#function-arguments"></a>
</h4>
<p>You can change several arguments in the function call to modify the
behavior of the function.</p>
<ul>
<li>
<code>root</code>
<ul>
<li>Set it to <code>NULL</code> if you only want to import the
association file without file system alignment. Beware that some of the
automated import functionalities won’t work!</li>
<li>Set it to a non-empty string (path on disk): in this case, the
column associated with the tag <code>proj_folder</code> (by default
<code>PathToFolderProjectID</code>) in the file should contain
<strong>relative</strong> file paths, so if for example your root is set
to “/home” and your project folder in the association file is set to
“/PJ01”, the function will check that the directory exists under
“/home/PJ01”</li>
<li>Set it to an empty string: ideal if you want to store paths in the
association file as <strong>absolute</strong> file paths. In this case
if your project folder is in “/home/PJ01” you should have this path in
the <code>PathToFolderProjectID</code> column and set <code>root</code>
= “”</li>
</ul>
</li>
<li>
<code>dates_format</code>: a string that is useful for properly
parsing dates from tabular formats</li>
<li>
<code>separator</code>: the column separator used in the file.
Defaults to “\t”, other valid separators are “,” (comma), “;”
(semi-colon)</li>
<li>
<code>filter_for</code>: you can set this argument to a
<strong>named</strong> list of filters, where names are column names.
For example <code>list(ProjectID = "PJ01")</code> will return only those
rows whose attribute “ProjectID” equals “PJ01”</li>
<li>
<code>import_iss</code>: either <code>TRUE</code> or
<code>FALSE</code>. If set to <code>TRUE</code>, performs an internal
call to <code><a href="../reference/import_Vispa2_stats.html">import_Vispa2_stats()</a></code> (see next section), and
appends the imported files to metadata</li>
<li>
<code>convert_tp</code>: either <code>TRUE</code> or
<code>FALSE</code>. Converts the column containing the time point
expressed in days in months and years (with custom logic).</li>
<li>
<code>report_path</code>
<ul>
<li>Set it to <code>NULL</code> to avoid the production of a report</li>
<li>Set it to a folder (if it doesn’t exist, it gets automatically
created)</li>
</ul>
</li>
<li>
<code>...</code>: additional named arguments to pass to
<code><a href="../reference/import_Vispa2_stats.html">import_Vispa2_stats()</a></code> if you chose to import VISPA2
stats</li>
</ul>
<p>For further details view the dedicated function documentation.</p>
<p><em>NOTE</em>: the function supports files in various formats as long
as the correct separator is provided. It also accepts files in
<code>*.xlsx</code> and <code>*.xls</code> formats but we do not
recommend using these since the report won’t include a detailed summary
of potential parsing problems.</p>
<p>The interactive report includes useful information such as</p>
<ul>
<li>General issues: parsing problems, missing columns, NA values in
important columns etc. This allows you to immediately spot problems and
correct them before proceeding with the analyses</li>
<li>File system alignment issues: very useful to know if all data can be
imported or folders are missing</li>
<li>Info on VISPA2 stats (if <code>import_iss</code> was
<code>TRUE</code>)</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="importing-vispa2-stats-files">Importing VISPA2 stats files<a class="anchor" aria-label="anchor" href="#importing-vispa2-stats-files"></a>
</h3>
<p>VISPA2 automatically produces summary files for each pool holding
information that can be useful for other analyses downstream, so it is
recommended to import them in the first steps of the workflow. To do
that, you can use <code>import_VISPA2_stats</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vispa_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_Vispa2_stats.html">import_Vispa2_stats</a></span><span class="op">(</span></span>
<span>    association_file <span class="op">=</span> <span class="va">af</span>,</span>
<span>    join_with_af <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    report_path <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 14</span></span></span>
<span><span class="co">#&gt;   POOL     TAG   RUN_N…¹ PHIX_…² PLASM…³ BARCO…⁴ LTR_I…⁵ TRIMM…⁶ LV_MA…⁷ BWA_M…⁸</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> POOL01-1 LTR7… PJ01|P…  4.36<span style="color: #949494;">e</span>7 2<span style="text-decoration: underline;">256</span>176  <span style="text-decoration: underline;">645</span>026  <span style="text-decoration: underline;">645</span>026  <span style="text-decoration: underline;">630</span>965  <span style="text-decoration: underline;">211</span>757  <span style="text-decoration: underline;">402</span>477</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> POOL01-1 LTR5… PJ01|P…  4.36<span style="color: #949494;">e</span>7 2<span style="text-decoration: underline;">256</span>176  <span style="text-decoration: underline;">652</span>208  <span style="text-decoration: underline;">652</span>177  <span style="text-decoration: underline;">649</span>044  <span style="text-decoration: underline;">303</span>300  <span style="text-decoration: underline;">322</span>086</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> POOL01-1 LTR8… PJ01|P…  4.36<span style="color: #949494;">e</span>7 2<span style="text-decoration: underline;">256</span>176  <span style="text-decoration: underline;">451</span>519  <span style="text-decoration: underline;">451</span>512  <span style="text-decoration: underline;">449</span>669  <span style="text-decoration: underline;">204</span>810  <span style="text-decoration: underline;">227</span>275</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> POOL01-1 LTR2… PJ01|P…  4.36<span style="color: #949494;">e</span>7 2<span style="text-decoration: underline;">256</span>176  <span style="text-decoration: underline;">426</span>500  <span style="text-decoration: underline;">426</span>499  <span style="text-decoration: underline;">425</span>666  <span style="text-decoration: underline;">185</span>752  <span style="text-decoration: underline;">223</span>915</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> POOL01-1 LTR6… PJ01|P…  4.36<span style="color: #949494;">e</span>7 2<span style="text-decoration: underline;">256</span>176   <span style="text-decoration: underline;">18</span>300   <span style="text-decoration: underline;">18</span>300   <span style="text-decoration: underline;">18</span>290    <span style="text-decoration: underline;">6</span>962   <span style="text-decoration: underline;">10</span>487</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> POOL01-1 LTR3… PJ01|P…  4.36<span style="color: #949494;">e</span>7 2<span style="text-decoration: underline;">256</span>176  <span style="text-decoration: underline;">729</span>327  <span style="text-decoration: underline;">729</span>327  <span style="text-decoration: underline;">727</span>219  <span style="text-decoration: underline;">318</span>653  <span style="text-decoration: underline;">369</span>117</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 4 more variables: ISS_MAPPED_OVERALL &lt;int&gt;, RAW_READS &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   QUALITY_PASSED &lt;lgl&gt;, ISS_MAPPED_PP &lt;lgl&gt;, and abbreviated variable names</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ¹​RUN_NAME, ²​PHIX_MAPPING, ³​PLASMID_MAPPED_BYPOOL, ⁴​BARCODE_MUX,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ⁵​LTR_IDENTIFIED, ⁶​TRIMMING_FINAL_LTRLC, ⁷​LV_MAPPED, ⁸​BWA_MAPPED_OVERALL</span></span></span></code></pre>
<p>The function requires as input the imported and file system aligned
association file and it will scan the <code>iss</code> folder for files
that match some known prefixes (defaults are already provided but you
can change them as you see fit). You can either choose to join the
imported data frames with the association file in input and obtain a
single data frame or keep it as it is, just set the parameter
<code>join_with_af</code> accordingly. At the end of the process an HTML
report is produced, signaling potential problems.</p>
<p>You can directly call this function when you import the association
file by setting the <code>import_iss</code> argument of
<code>import_association_file</code> to <code>TRUE</code>.</p>
</div>
<div class="section level3">
<h3 id="importing-a-single-integration-matrix">Importing a single integration matrix<a class="anchor" aria-label="anchor" href="#importing-a-single-integration-matrix"></a>
</h3>
<p>If you want to import a single integration matrix you can do so by
using the <code><a href="../reference/import_single_Vispa2Matrix.html">import_single_Vispa2Matrix()</a></code> function. This
function reads the file and converts it into a tidy structure: several
different formats can be read, since you can specify the column
separator.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">matrix_path</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path.html" class="external-link">path</a></span><span class="op">(</span><span class="va">fs_path</span><span class="op">$</span><span class="va">root</span>,</span>
<span>                        <span class="st">"PJ01"</span>,</span>
<span>                        <span class="st">"quantification"</span>,</span>
<span>                        <span class="st">"POOL01-1"</span>,</span>
<span>                        <span class="st">"PJ01_POOL01-1_seqCount_matrix.no0.annotated.tsv.gz"</span><span class="op">)</span></span>
<span><span class="va">matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_single_Vispa2Matrix.html">import_single_Vispa2Matrix</a></span><span class="op">(</span><span class="va">matrix_path</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;      chr integration_locus strand     GeneName GeneStrand</span></span>
<span><span class="co">#&gt;   1:  16          68164148      +       NFATC3          +</span></span>
<span><span class="co">#&gt;   2:   4         129390130      + LOC100507487          +</span></span>
<span><span class="co">#&gt;   3:   5          84009671      -        EDIL3          -</span></span>
<span><span class="co">#&gt;   4:  12          54635693      -         CBX5          -</span></span>
<span><span class="co">#&gt;   5:   2         181930711      +       UBE2E3          +</span></span>
<span><span class="co">#&gt;  ---                                                     </span></span>
<span><span class="co">#&gt; 798:  11          72729902      -       FCHSD2          -</span></span>
<span><span class="co">#&gt; 799:  12         133238196      +         POLE          -</span></span>
<span><span class="co">#&gt; 800:  20          10028583      -       ANKEF1          +</span></span>
<span><span class="co">#&gt; 801:  12          50594351      +        LIMA1          -</span></span>
<span><span class="co">#&gt; 802:   5          84009671      -        EDIL3          -</span></span>
<span><span class="co">#&gt;                                                   CompleteAmplificationID Value</span></span>
<span><span class="co">#&gt;   1: PJ01_POOL01_LTR75LC38_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC   182</span></span>
<span><span class="co">#&gt;   2: PJ01_POOL01_LTR75LC38_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC     4</span></span>
<span><span class="co">#&gt;   3: PJ01_POOL01_LTR75LC38_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC     5</span></span>
<span><span class="co">#&gt;   4: PJ01_POOL01_LTR75LC38_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC     9</span></span>
<span><span class="co">#&gt;   5: PJ01_POOL01_LTR75LC38_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC    83</span></span>
<span><span class="co">#&gt;  ---                                                                           </span></span>
<span><span class="co">#&gt; 798: PJ01_POOL01_LTR29LC90_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC     1</span></span>
<span><span class="co">#&gt; 799: PJ01_POOL01_LTR29LC90_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC     2</span></span>
<span><span class="co">#&gt; 800: PJ01_POOL01_LTR29LC90_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC     8</span></span>
<span><span class="co">#&gt; 801:  PJ01_POOL01_LTR53LC22_PT001_PT001-93_lenti_GLOBE_PB_1_SLiM_0030_MNC     1</span></span>
<span><span class="co">#&gt; 802:   PJ01_POOL01_LTR9LC80_PT001_PT001-74_lenti_GLOBE_PB_1_SLiM_0180_MNC     1</span></span></code></pre>
<p>For details on usage and arguments view the dedicated function
documentation.</p>
</div>
<div class="section level3">
<h3 id="automated-integration-matrices-import">Automated integration matrices import<a class="anchor" aria-label="anchor" href="#automated-integration-matrices-import"></a>
</h3>
<p>Integration matrices import can be automated when when the
association file is imported with the file system alignment option.
<code>ISAnalytics</code> provides a function,
<code><a href="../reference/import_parallel_Vispa2Matrices.html">import_parallel_Vispa2Matrices()</a></code>, that allows to do just
that in a fast and efficient way.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_options.html" class="external-link">with_options</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ISAnalytics.reports <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, <span class="op">{</span></span>
<span>    <span class="va">matrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_parallel_Vispa2Matrices.html">import_parallel_Vispa2Matrices</a></span><span class="op">(</span><span class="va">af</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span>,</span>
<span>        mode <span class="op">=</span> <span class="st">"AUTO"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="function-arguments-1">Function arguments<a class="anchor" aria-label="anchor" href="#function-arguments-1"></a>
</h3>
<p>Let’s see how the behavior of the function changes when we change
arguments.</p>
<div class="section level4">
<h4 id="association_file-argument">
<code>association_file</code> argument<a class="anchor" aria-label="anchor" href="#association_file-argument"></a>
</h4>
<p>You can supply a data frame object, imported via
<code><a href="../reference/import_association_file.html">import_association_file()</a></code> (see Section @ref(metadata)) or a
string (the path to the association file on disk). In the first scenario
it is necessary to perform file system alignment, since the function
scans the folders contained in the column <code>Path_quant</code>, while
in the second case you should also provide as additional
<strong>named</strong> argument (to <code>...</code>) an appropriate
<code>root</code>: the function will internally call
<code><a href="../reference/import_association_file.html">import_association_file()</a></code>, if you don’t have specific needs
we recommend doing the 2 steps separately and provide the association
file as a data frame.</p>
</div>
<div class="section level4">
<h4 id="quantification_type-argument">
<code>quantification_type</code> argument<a class="anchor" aria-label="anchor" href="#quantification_type-argument"></a>
</h4>
<p>For each pool there may be multiple available quantification types,
that is, different matrices containing the same samples and same genomic
features but a different quantification. A typical workflow contemplates
<code>seqCount</code> and <code>fragmentEstimate</code>, all the
supported quantification types can be viewed with
<code><a href="../reference/quantification_types.html">quantification_types()</a></code>.</p>
</div>
<div class="section level4">
<h4 id="matrix_type-argument">
<code>matrix_type</code> argument<a class="anchor" aria-label="anchor" href="#matrix_type-argument"></a>
</h4>
<p>As we mentioned in Section @ref(notation), annotation columns are
optional and may not be included in some matrices. This argument allows
you to specify the function to look for only a specific type of matrix,
either <code>annotated</code> or <code>not_annotated</code>.</p>
<p>File suffixes for matrices are specified via
<code><a href="../reference/mandatory_IS_vars.html">matrix_file_suffixes()</a></code>.</p>
</div>
<div class="section level4">
<h4 id="workers-argument">
<code>workers</code> argument<a class="anchor" aria-label="anchor" href="#workers-argument"></a>
</h4>
<p>Sets the number of parallel workers to set up. This highly depends on
the hardware configuration of your machine.</p>
</div>
<div class="section level4">
<h4 id="multi_quant_matrix-argument">
<code>multi_quant_matrix</code> argument<a class="anchor" aria-label="anchor" href="#multi_quant_matrix-argument"></a>
</h4>
<p>When importing more than one quantification at once, it can be very
handy to have all data in a single data frame rather than two. If set to
<code>TRUE</code> the function will internally call
<code><a href="../reference/comparison_matrix.html">comparison_matrix()</a></code> and produce a single data frames that
has a dedicated column for each quantification. For example, for the
matrices we’ve imported before:</p>
<pre><code><span><span class="co">#&gt;    chr integration_locus strand     GeneName GeneStrand</span></span>
<span><span class="co">#&gt; 1:  16          68164148      +       NFATC3          +</span></span>
<span><span class="co">#&gt; 2:   4         129390130      + LOC100507487          +</span></span>
<span><span class="co">#&gt; 3:   5          84009671      -        EDIL3          -</span></span>
<span><span class="co">#&gt; 4:  12          54635693      -         CBX5          -</span></span>
<span><span class="co">#&gt; 5:   2         181930711      +       UBE2E3          +</span></span>
<span><span class="co">#&gt; 6:  20          35920986      +       MANBAL          +</span></span>
<span><span class="co">#&gt;                                                 CompleteAmplificationID</span></span>
<span><span class="co">#&gt; 1: PJ01_POOL01_LTR75LC38_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC</span></span>
<span><span class="co">#&gt; 2: PJ01_POOL01_LTR75LC38_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC</span></span>
<span><span class="co">#&gt; 3: PJ01_POOL01_LTR75LC38_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC</span></span>
<span><span class="co">#&gt; 4: PJ01_POOL01_LTR75LC38_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC</span></span>
<span><span class="co">#&gt; 5: PJ01_POOL01_LTR75LC38_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC</span></span>
<span><span class="co">#&gt; 6: PJ01_POOL01_LTR75LC38_PT001_PT001-103_lenti_GLOBE_PB_1_SLiM_0060_MNC</span></span>
<span><span class="co">#&gt;    fragmentEstimate seqCount</span></span>
<span><span class="co">#&gt; 1:       102.945718      182</span></span>
<span><span class="co">#&gt; 2:         3.013590        4</span></span>
<span><span class="co">#&gt; 3:         5.033742        5</span></span>
<span><span class="co">#&gt; 4:         9.129338        9</span></span>
<span><span class="co">#&gt; 5:        50.502734       83</span></span>
<span><span class="co">#&gt; 6:        16.394422       39</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="report_path-argument">
<code>report_path</code> argument<a class="anchor" aria-label="anchor" href="#report_path-argument"></a>
</h4>
<p>As other import functions, also
<code><a href="../reference/import_parallel_Vispa2Matrices.html">import_parallel_Vispa2Matrices()</a></code> produces an interactive
report, use this argument to set the appropriate path were the report
should be saved.</p>
</div>
<div class="section level4">
<h4 id="mode-argument">
<code>mode</code> argument<a class="anchor" aria-label="anchor" href="#mode-argument"></a>
</h4>
<p>This argument can take one of two values, <code>AUTO</code> or
<code>INTERACTIVE</code>. The <code>INTERACTIVE</code> workflow, as the
name suggests, needs user console input but allows a fine tuning of the
import process. On the other hand, <code>AUTO</code> allows a fully
automated workflow but has of course some limitations.</p>
<p><strong>What do you want to import?</strong><br>
In a fully automated mode, the function will try to import everything
that is contained in the input association file. This means that if you
need to import only a specific set of projects/pools, you will need to
filter the association file accordingly prior calling the function (you
can easily do that via the <code>filter_for</code> argument as explained
in Section @ref(metadata)). In interactive mode the function will ask
you to type what you want to import.</p>
<p><strong>How to deal with duplicates?</strong><br>
When scanning folders for files that match a given pattern (in our case
the function looks for matrices that match the quantification type and
the matrix type), it is very possible that the same folder contains
multiple files for the same quantification. Of course this is not
recommended, we suggest to move the duplicated files in a sub directory
or remove them if they’re not necessary, but in case this happens, in
interactive mode, the function asks directly which files should be
considered. Of course this is not possible in automated mode, therefore
you need to set two other arguments (described in the next sub sections)
to “help” the function discriminate between duplicates. Please note that
if such discrimination is not possible no files are imported.</p>
</div>
<div class="section level4">
<h4 id="patterns-argument">
<code>patterns</code> argument<a class="anchor" aria-label="anchor" href="#patterns-argument"></a>
</h4>
<p>This argument is relevant only if <code>mode</code> is set to
<code>AUTO</code>. Providing a set of patterns (interpreted as regular
expressions) helps the function to choose between duplicated files if
any are found. If you’re confident your folders don’t contain any
duplicates feel free to ignore this argument.</p>
</div>
<div class="section level4">
<h4 id="matching_opt-argument">
<code>matching_opt</code> argument<a class="anchor" aria-label="anchor" href="#matching_opt-argument"></a>
</h4>
<p>This argument is relevant only if <code>mode</code> is set to
<code>AUTO</code> and <code>patterns</code> isn’t <code>NULL</code>.
Tells the function how to match the given patterns if multiple are
supplied: <code>ALL</code> means keep only those files whose name
matches all the given patterns, <code>ANY</code> means keep only those
files whose name matches any of the given patterns and
<code>OPTIONAL</code> expresses a preference, try to find files that
contain the patterns and if you don’t find any return whatever you
find.</p>
</div>
<div class="section level4">
<h4 id="argument">
<code>...</code> argument<a class="anchor" aria-label="anchor" href="#argument"></a>
</h4>
<p>Additional named arguments to supply to both
<code><a href="../reference/import_association_file.html">import_association_file()</a></code> and
<code><a href="../reference/comparison_matrix.html">comparison_matrix()</a></code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h3>
<p>Earlier versions of the package featured two separated functions,
<code><a href="../reference/import_parallel_Vispa2Matrices_auto.html">import_parallel_Vispa2Matrices_auto()</a></code> and
<code><a href="../reference/import_parallel_Vispa2Matrices_interactive.html">import_parallel_Vispa2Matrices_interactive()</a></code>. Those
functions are now officially deprecated (since
<code>ISAnalytics 1.3.3</code>) and will be defunct on the next release
cycle.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-cleaning-and-pre-processing">Data cleaning and pre-processing<a class="anchor" aria-label="anchor" href="#data-cleaning-and-pre-processing"></a>
</h2>
<p>This section goes more in detail on some data cleaning and
pre-processing operations you can perform with this package.</p>
<p>ISAnalytics offers several different functions for cleaning and
pre-processing your data.</p>
<ul>
<li>Recalibration: identifies integration events that are near to each
other and condenses them into a single event whenever appropriate -
<code><a href="../reference/compute_near_integrations.html">compute_near_integrations()</a></code>
</li>
<li>Outliers identification and removal: identifies samples that are
considered outliers according to user-defined logic and filters them out
- <code><a href="../reference/outlier_filter.html">outlier_filter()</a></code>
</li>
<li>Collision removal: identifies collision events between independent
samples - <code><a href="../reference/remove_collisions.html">remove_collisions()</a></code>
</li>
<li>Filter based on cell lineage purity: identifies and removes
contamination between different cell types -
<code><a href="../reference/purity_filter.html">purity_filter()</a></code>
</li>
<li>Data and metadata aggregation: allows the union of biological
samples from single pcr replicates or other arbitrary aggregations -
<code><a href="../reference/aggregate_values_by_key.html">aggregate_values_by_key()</a></code>,
<code><a href="../reference/aggregate_metadata.html">aggregate_metadata()</a></code>
</li>
</ul>
<div class="section level3">
<h3 id="removing-collisions">Removing collisions<a class="anchor" aria-label="anchor" href="#removing-collisions"></a>
</h3>
<p>In this section we illustrate the functions dedicated to collision
removal.</p>
<div class="section level4">
<h4 id="what-is-a-collision-and-why-should-you-care">What is a collision and why should you care?<a class="anchor" aria-label="anchor" href="#what-is-a-collision-and-why-should-you-care"></a>
</h4>
<p>We’re not going into too much detail here, but we’re going to explain
in a very simple way what a “collision” is and how the function in this
package deals with them.</p>
<p>We say that an integration (aka a unique combination of
<code><a href="../reference/mandatory_IS_vars.html">mandatory_IS_vars()</a></code>) is a <em>collision</em> if this
combination is shared between different independent samples: an
independent sample is a unique combination of metadata fields specified
by the user. The reason behind this is that it’s highly improbable to
observe the very same integration in two different independent samples
and this phenomenon might be an indicator of some kind of contamination
in the sequencing phase or in PCR phase, for this reason we might want
to exclude such contamination from our analysis.
<code>ISAnalytics</code> provides a function that processes the imported
data for the removal or reassignment of these “problematic”
integrations, <code><a href="../reference/remove_collisions.html">remove_collisions()</a></code>.</p>
<p>The processing is done using the sequence count value, so the
corresponding matrix is needed for this operation.</p>
</div>
<div class="section level4">
<h4 id="the-logic-behind-the-function">The logic behind the function<a class="anchor" aria-label="anchor" href="#the-logic-behind-the-function"></a>
</h4>
<p>The <code><a href="../reference/remove_collisions.html">remove_collisions()</a></code> function follows several logical
steps to decide whether an integration is a collision and if it is it
decides whether to re-assign it or remove it entirely based on different
criteria.</p>
<div class="section level5">
<h5 id="identifying-the-collisions">Identifying the collisions<a class="anchor" aria-label="anchor" href="#identifying-the-collisions"></a>
</h5>
<p>The function uses the information stored in the association file to
assess which independent samples are present and counts the number of
independent samples for each integration: those who have a count &gt; 1
are considered collisions.</p>
<table class="table">
<caption>Example of collisions: the same integration (1, 123454, +) is
found in 2 different independent samples ((SUBJ01, PJ01) &amp; (SUBJ02,
PJ01))</caption>
<colgroup>
<col width="4%">
<col width="21%">
<col width="8%">
<col width="10%">
<col width="29%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">chr</th>
<th align="right">integration_locus</th>
<th align="left">strand</th>
<th align="right">seqCount</th>
<th align="left">CompleteAmplificationID</th>
<th align="left">SubjectID</th>
<th align="left">ProjectID</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">123454</td>
<td align="left">+</td>
<td align="right">653</td>
<td align="left">SAMPLE1</td>
<td align="left">SUBJ01</td>
<td align="left">PJ01</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">123454</td>
<td align="left">+</td>
<td align="right">456</td>
<td align="left">SAMPLE2</td>
<td align="left">SUBJ02</td>
<td align="left">PJ01</td>
</tr>
</tbody>
</table>
</div>
<div class="section level5">
<h5 id="re-assign-vs-remove">Re-assign vs remove<a class="anchor" aria-label="anchor" href="#re-assign-vs-remove"></a>
</h5>
<p>Once the collisions are identified, the function follows 3 steps
where it tries to re-assign the combination to a single independent
sample. The criteria are:</p>
<ol style="list-style-type: decimal">
<li>Compare dates: if it’s possible to have an absolute ordering on
dates, the integration is re-assigned to the sample that has the
earliest date. If two samples share the same date it’s impossible to
decide, so the next criteria is tested</li>
<li>Compare replicate number: if a sample has the same integration in
more than one replicate, it’s more probable the integration is not an
artifact. If it’s possible to have an absolute ordering, the collision
is re-assigned to the sample whose grouping is largest</li>
<li>Compare the sequence count value: if the previous criteria wasn’t
sufficient to make a decision, for each group of independent samples
it’s evaluated the sum of the sequence count value - for each group
there is a cumulative value of the sequence count and this is compared
to the value of other groups. If there is a single group which has a
ratio n times bigger than other groups, this one is chosen for
re-assignment. The factor n is passed as a parameter in the function
(<code>reads_ratio</code>), the default value is 10.</li>
</ol>
<p>If none of the criteria were sufficient to make a decision, the
integration is simply removed from the matrix.</p>
</div>
</div>
<div class="section level4">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h4>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"integration_matrices"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"association_file"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span>
<span><span class="co">## Multi quantification matrix</span></span>
<span><span class="va">no_coll</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_collisions.html">remove_collisions</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">integration_matrices</span>,</span>
<span>                             association_file <span class="op">=</span> <span class="va">association_file</span>,</span>
<span>                             report_path <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; Identifying collisions...</span></span>
<span><span class="co">#&gt; Processing collisions...</span></span>
<span><span class="co">#&gt; Finished!</span></span>
<span><span class="co">## Matrix list</span></span>
<span><span class="va">separated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/separate_quant_matrices.html">separate_quant_matrices</a></span><span class="op">(</span><span class="va">integration_matrices</span><span class="op">)</span></span>
<span><span class="va">no_coll_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_collisions.html">remove_collisions</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">separated</span>,</span>
<span>                             association_file <span class="op">=</span> <span class="va">association_file</span>,</span>
<span>                             report_path <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; Identifying collisions...</span></span>
<span><span class="co">#&gt; Processing collisions...</span></span>
<span><span class="co">#&gt; Finished!</span></span>
<span><span class="co">## Only sequence count</span></span>
<span><span class="va">no_coll_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_collisions.html">remove_collisions</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">separated</span><span class="op">$</span><span class="va">seqCount</span>,</span>
<span>                             association_file <span class="op">=</span> <span class="va">association_file</span>,</span>
<span>                             quant_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>seqCount <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span>,</span>
<span>                             report_path <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; Identifying collisions...</span></span>
<span><span class="co">#&gt; Processing collisions...</span></span>
<span><span class="co">#&gt; Finished!</span></span></code></pre></div>
<p>Important notes on the association file:</p>
<ul>
<li>You have to be sure your association file is properly filled out.
The function requires you to specify a date column (by default
“SequencingDate”), you have to ensure this column doesn’t contain NA
values or incorrect values.</li>
</ul>
<p>The function accepts different inputs, namely:</p>
<ul>
<li>A multi-quantification matrix: this is always the recommended
approach</li>
<li>A named list of matrices where names are quantification types in
<code><a href="../reference/quantification_types.html">quantification_types()</a></code>
</li>
<li>The single sequence count matrix: this is not the recommended
approach since it requires a realignment step for other quantification
matrices if you have them.</li>
</ul>
<p>If the option <code>ISAnalytics.reports</code> is active, an
interactive report in HTML format will be produced at the specified
path.</p>
</div>
<div class="section level4">
<h4 id="re-align-other-matrices">Re-align other matrices<a class="anchor" aria-label="anchor" href="#re-align-other-matrices"></a>
</h4>
<p>If you’ve given as input the standalone sequence count matrix to
<code><a href="../reference/remove_collisions.html">remove_collisions()</a></code>, to realign other matrices you have to
call the function <code><a href="../reference/realign_after_collisions.html">realign_after_collisions()</a></code>, passing as
input the processed sequence count matrix and the named list of other
matrices to realign. <strong>NOTE: the names in the list must be
quantification types.</strong></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">other_realigned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/realign_after_collisions.html">realign_after_collisions</a></span><span class="op">(</span></span>
<span>  sc_matrix <span class="op">=</span> <span class="va">no_coll_single</span>,</span>
<span>  other_matrices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fragmentEstimate <span class="op">=</span> <span class="va">separated</span><span class="op">$</span><span class="va">fragmentEstimate</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="performing-data-and-metadata-aggregation">Performing data and metadata aggregation<a class="anchor" aria-label="anchor" href="#performing-data-and-metadata-aggregation"></a>
</h3>
<p>In this section we’re going to explain in detail how to use functions
of the aggregate family, namely:</p>
<ol style="list-style-type: decimal">
<li><code><a href="../reference/aggregate_metadata.html">aggregate_metadata()</a></code></li>
<li><code><a href="../reference/aggregate_values_by_key.html">aggregate_values_by_key()</a></code></li>
</ol>
<div class="section level4">
<h4 id="aggregating-metadata">Aggregating metadata<a class="anchor" aria-label="anchor" href="#aggregating-metadata"></a>
</h4>
<p>We refer to information contained in the association file as
“metadata”: sometimes it’s useful to obtain collective information based
on a certain group of variables we’re interested in. The function
<code><a href="../reference/aggregate_metadata.html">aggregate_metadata()</a></code> does just that: according to the
grouping variables, meaning the names of the columns in the association
file to perform a <code>group_by</code> operation with,it creates a
summary. You can fully customize the summary by providing a “function
table” that tells the function which operation should be applied to
which column and what name to give to the output column. A default is
already supplied:</p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 4</span></span></span>
<span><span class="co">#&gt;    Column               Function  Args  Output_colname</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> FusionPrimerPCRDate  <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}_min    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> LinearPCRDate        <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}_min    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> VCN                  <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}_avg    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> ng DNA corrected     <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}_avg    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Kapa                 <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}_avg    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> ng DNA corrected     <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}_sum    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> ulForPool            <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}_sum    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> BARCODE_MUX          <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}_sum    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> TRIMMING_FINAL_LTRLC <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}_sum    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> LV_MAPPED            <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}_sum    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> BWA_MAPPED_OVERALL   <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}_sum    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> ISS_MAPPED_OVERALL   <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}_sum    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> PCRMethod            <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> NGSTechnology        <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> DNAnumber            <span style="color: #949494;">&lt;formula&gt;</span> <span style="color: #BB0000;">NA</span>    {.col}</span></span></code></pre>
<p>You can either provide purrr-style lambdas (as given in the example
above), or simply specify the name of the function and additional
parameters as a list in a separated column. If you choose to provide
your own table you should maintain the column names for the function to
work properly. For more details on this take a look at the function
documentation <code><a href="../reference/default_meta_agg.html">?default_meta_agg</a></code>.</p>
<div class="section level5">
<h5 id="typical-workflow">Typical workflow<a class="anchor" aria-label="anchor" href="#typical-workflow"></a>
</h5>
<ol style="list-style-type: decimal">
<li>Import the association file via
<code>import_assocition_file()</code>. If you need more information on
import function please view the vignette “How to use import functions”:
<code>vignette("how_to_import_functions", package="ISAnalytics")</code>.</li>
<li>Perform aggregation</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"association_file"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span>
<span><span class="va">aggregated_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_metadata.html">aggregate_metadata</a></span><span class="op">(</span>association_file <span class="op">=</span> <span class="va">association_file</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 19</span></span></span>
<span><span class="co">#&gt;    Subjec…¹ CellM…² Tissue TimeP…³ FusionPr…⁴ LinearPC…⁵ VCN_avg ng DN…⁶ Kapa_…⁷</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> PT001    MNC     BM     0030    2016-11-03 Inf           0.26   300.    <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> PT001    MNC     BM     0060    2016-11-03 Inf           0.42   171.    <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> PT001    MNC     BM     0090    2016-11-03 Inf           0.35    89.2   <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> PT001    MNC     BM     0180    2016-11-03 Inf           0.27   181.    <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> PT001    MNC     BM     0360    2017-04-21 Inf           0.18    42     <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> PT001    MNC     PB     0030    2016-11-03 Inf           0.23    23.8   <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> PT001    MNC     PB     0060    2016-11-03 Inf           0.3     23.2   <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> PT001    MNC     PB     0090    2016-11-03 Inf           0.26    26.6   <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> PT001    MNC     PB     0180    2016-11-03 Inf           0.24    23.1   <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> PT001    MNC     PB     0360    2017-04-21 Inf           0.19    45.2   <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> PT002    MNC     BM     0030    2017-04-21 Inf           1.01   182.    <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> PT002    MNC     BM     0060    2017-05-05 Inf           1.24   172.    <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> PT002    MNC     BM     0090    2017-05-05 Inf           2.05   135.    <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> PT002    MNC     BM     0180    2017-05-16 Inf           2.3    196.    <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> PT002    MNC     BM     0360    2018-03-12 Inf           2.52   299.     38.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> PT002    MNC     PB     0030    2017-04-21 Inf           0.77   106.    <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> PT002    MNC     PB     0060    2017-05-05 Inf           1.07    77.4   <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> PT002    MNC     PB     0090    2017-05-05 Inf           1.09   123     <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> PT002    MNC     PB     0180    2017-05-05 Inf           1.43   123.    <span style="color: #BB0000;">NaN</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> PT002    MNC     PB     0360    2018-03-12 Inf           2.07   300.     22.0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 10 more variables: `ng DNA corrected_sum` &lt;dbl&gt;, ulForPool_sum &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   BARCODE_MUX_sum &lt;int&gt;, TRIMMING_FINAL_LTRLC_sum &lt;int&gt;, LV_MAPPED_sum &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   BWA_MAPPED_OVERALL_sum &lt;int&gt;, ISS_MAPPED_OVERALL_sum &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   PCRMethod &lt;chr&gt;, NGSTechnology &lt;chr&gt;, DNAnumber &lt;chr&gt;, and abbreviated</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   variable names ¹​SubjectID, ²​CellMarker, ³​TimePoint,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ⁴​FusionPrimerPCRDate_min, ⁵​LinearPCRDate_min, ⁶​`ng DNA corrected_avg`,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ⁷​Kapa_avg</span></span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="aggregation-of-values-by-key">Aggregation of values by key<a class="anchor" aria-label="anchor" href="#aggregation-of-values-by-key"></a>
</h4>
<p><code>ISAnalytics</code> contains useful functions to aggregate the
values contained in your imported matrices based on a key, aka a single
column or a combination of columns contained in the association file
that are related to the samples.</p>
<div class="section level5">
<h5 id="typical-workflow-1">Typical workflow<a class="anchor" aria-label="anchor" href="#typical-workflow-1"></a>
</h5>
<ol style="list-style-type: decimal">
<li>Import your association file</li>
<li>Import integration matrices via
<code><a href="../reference/import_parallel_Vispa2Matrices.html">import_parallel_Vispa2Matrices()</a></code>
</li>
<li>Perform aggregation</li>
</ol>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"integration_matrices"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"association_file"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span>
<span><span class="va">aggreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_values_by_key.html">aggregate_values_by_key</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">integration_matrices</span>, </span>
<span>  association_file <span class="op">=</span> <span class="va">association_file</span>,</span>
<span>  value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,074 × 11</span></span></span>
<span><span class="co">#&gt;    chr   integration_locus strand GeneName GeneStrand SubjectID CellMarker</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1               8<span style="text-decoration: underline;">464</span>757 -      RERE     -          PT001     MNC       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1               8<span style="text-decoration: underline;">464</span>757 -      RERE     -          PT001     MNC       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1               8<span style="text-decoration: underline;">607</span>357 +      RERE     -          PT001     MNC       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1               8<span style="text-decoration: underline;">607</span>357 +      RERE     -          PT001     MNC       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1               8<span style="text-decoration: underline;">607</span>357 +      RERE     -          PT001     MNC       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1               8<span style="text-decoration: underline;">607</span>362 -      RERE     -          PT001     MNC       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1               8<span style="text-decoration: underline;">850</span>362 +      RERE     -          PT002     MNC       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1              11<span style="text-decoration: underline;">339</span>120 +      UBIAD1   +          PT001     MNC       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1              11<span style="text-decoration: underline;">339</span>120 +      UBIAD1   +          PT001     MNC       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1              11<span style="text-decoration: underline;">339</span>120 +      UBIAD1   +          PT001     MNC       </span></span>
<span><span class="co">#&gt;    Tissue TimePoint seqCount_sum fragmentEstimate_sum</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> BM     0030               542                 3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> BM     0060                 1                 1.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> BM     0060                 1                 1.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> BM     0180              <span style="text-decoration: underline;">1</span>096                 5.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> BM     0360               330                34.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> BM     0180              <span style="text-decoration: underline;">1</span>702                 4.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> BM     0360               562                 3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> BM     0060              <span style="text-decoration: underline;">1</span>605                 8.03</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> PB     0060                 1                 1.00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> PB     0180                 1                 1.00</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 1,064 more rows</span></span></span></code></pre>
<p>The function <code>aggregate_values_by_key</code> can perform the
aggregation both on the list of matrices and a single matrix.</p>
<div class="section level6">
<h6 id="changing-parameters-to-obtain-different-results">Changing parameters to obtain different results<a class="anchor" aria-label="anchor" href="#changing-parameters-to-obtain-different-results"></a>
</h6>
<p>The function has several different parameters that have default
values that can be changed according to user preference.</p>
<ol style="list-style-type: decimal">
<li>
<strong>Changing the <code>key</code> value</strong><br>
You can change the value of the parameter key as you see fit. This
parameter should contain one or multiple columns of the association file
that you want to include in the grouping when performing the
aggregation. The default value is set to
<code>c("SubjectID", "CellMarker", "Tissue", "TimePoint")</code> (same
default key as the <code>aggregate_metadata</code> function).</li>
</ol>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agg1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_values_by_key.html">aggregate_values_by_key</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">integration_matrices</span>,</span>
<span>    association_file <span class="op">=</span> <span class="va">association_file</span>,</span>
<span>    key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SubjectID"</span>, <span class="st">"ProjectID"</span><span class="op">)</span>,</span>
<span>    value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 577 × 9</span></span></span>
<span><span class="co">#&gt;    chr   integration_locus strand GeneName GeneStrand SubjectID ProjectID</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1               8<span style="text-decoration: underline;">464</span>757 -      RERE     -          PT001     PJ01     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1               8<span style="text-decoration: underline;">607</span>357 +      RERE     -          PT001     PJ01     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1               8<span style="text-decoration: underline;">607</span>362 -      RERE     -          PT001     PJ01     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1               8<span style="text-decoration: underline;">850</span>362 +      RERE     -          PT002     PJ01     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1              11<span style="text-decoration: underline;">339</span>120 +      UBIAD1   +          PT001     PJ01     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1              12<span style="text-decoration: underline;">341</span>466 -      VPS13D   +          PT002     PJ01     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1              14<span style="text-decoration: underline;">034</span>054 -      PRDM2    +          PT002     PJ01     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1              16<span style="text-decoration: underline;">186</span>297 -      SPEN     +          PT001     PJ01     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1              16<span style="text-decoration: underline;">602</span>483 +      FBXO42   -          PT001     PJ01     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1              16<span style="text-decoration: underline;">602</span>483 +      FBXO42   -          PT002     PJ01     </span></span>
<span><span class="co">#&gt;    seqCount_sum fragmentEstimate_sum</span></span>
<span><span class="co">#&gt;           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>          543                 4.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         <span style="text-decoration: underline;">1</span>427                40.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         <span style="text-decoration: underline;">1</span>702                 4.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>          562                 3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         <span style="text-decoration: underline;">1</span>607                10.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         <span style="text-decoration: underline;">1</span>843                 8.05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         <span style="text-decoration: underline;">1</span>938                 3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         <span style="text-decoration: underline;">3</span>494                16.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         <span style="text-decoration: underline;">2</span>947                 9.04</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>           30                 2.00</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 567 more rows</span></span></span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Changing the <code>lambda</code> value</strong><br>
The <code>lambda</code> parameter indicates the function(s) to be
applied to the values for aggregation. <code>lambda</code> must be a
named list of either functions or purrr-style lambdas: if you would like
to specify additional parameters to the function the second option is
recommended. The only important note on functions is that they should
perform some kind of aggregation on numeric values: this means in
practical terms they need to accept a vector of numeric/integer values
as input and produce a SINGLE value as output. Valid options for this
purpose might be: <code>sum</code>, <code>mean</code>,
<code>median</code>, <code>min</code>, <code>max</code> and so on.</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agg2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_values_by_key.html">aggregate_values_by_key</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">integration_matrices</span>,</span>
<span>    association_file <span class="op">=</span> <span class="va">association_file</span>,</span>
<span>    key <span class="op">=</span> <span class="st">"SubjectID"</span>,</span>
<span>    lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 577 × 8</span></span></span>
<span><span class="co">#&gt;    chr   integration_locus strand GeneName GeneStrand SubjectID seqCount_mean</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1               8<span style="text-decoration: underline;">464</span>757 -      RERE     -          PT001              272.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1               8<span style="text-decoration: underline;">607</span>357 +      RERE     -          PT001              285.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1               8<span style="text-decoration: underline;">607</span>362 -      RERE     -          PT001              851 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1               8<span style="text-decoration: underline;">850</span>362 +      RERE     -          PT002              562 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1              11<span style="text-decoration: underline;">339</span>120 +      UBIAD1   +          PT001              321.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1              12<span style="text-decoration: underline;">341</span>466 -      VPS13D   +          PT002             <span style="text-decoration: underline;">1</span>843 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1              14<span style="text-decoration: underline;">034</span>054 -      PRDM2    +          PT002             <span style="text-decoration: underline;">1</span>938 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1              16<span style="text-decoration: underline;">186</span>297 -      SPEN     +          PT001              699.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1              16<span style="text-decoration: underline;">602</span>483 +      FBXO42   -          PT001              982.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1              16<span style="text-decoration: underline;">602</span>483 +      FBXO42   -          PT002               30 </span></span>
<span><span class="co">#&gt;    fragmentEstimate_mean</span></span>
<span><span class="co">#&gt;                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>                  2.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>                  8.02</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>                  2.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>                  3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>                  2.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>                  8.05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>                  3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>                  3.22</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>                  3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>                  2.00</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 567 more rows</span></span></span></code></pre>
<p>Note that, when specifying purrr-style lambdas (formulas), the first
parameter needs to be set to <code>.x</code>, other parameters can be
set as usual.</p>
<p>You can also use in <code>lambda</code> functions that produce data
frames or lists. In this case all variables from the produced data frame
will be included in the final data frame. For example:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agg3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_values_by_key.html">aggregate_values_by_key</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">integration_matrices</span>,</span>
<span>    association_file <span class="op">=</span> <span class="va">association_file</span>,</span>
<span>    key <span class="op">=</span> <span class="st">"SubjectID"</span>,</span>
<span>    lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>describe <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/describe.html" class="external-link">describe</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 577 × 8</span></span></span>
<span><span class="co">#&gt;    chr   integration_locus strand GeneName GeneStrand SubjectID</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1               8<span style="text-decoration: underline;">464</span>757 -      RERE     -          PT001    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1               8<span style="text-decoration: underline;">607</span>357 +      RERE     -          PT001    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1               8<span style="text-decoration: underline;">607</span>362 -      RERE     -          PT001    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1               8<span style="text-decoration: underline;">850</span>362 +      RERE     -          PT002    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1              11<span style="text-decoration: underline;">339</span>120 +      UBIAD1   +          PT001    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1              12<span style="text-decoration: underline;">341</span>466 -      VPS13D   +          PT002    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1              14<span style="text-decoration: underline;">034</span>054 -      PRDM2    +          PT002    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1              16<span style="text-decoration: underline;">186</span>297 -      SPEN     +          PT001    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1              16<span style="text-decoration: underline;">602</span>483 +      FBXO42   -          PT001    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1              16<span style="text-decoration: underline;">602</span>483 +      FBXO42   -          PT002    </span></span>
<span><span class="co">#&gt;    seqCount_describe fragmentEstimate_describe</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>  <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>  <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>  <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>  <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>  <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>  <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>  <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>  <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>  <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>  <span style="color: #949494;">&lt;psych [1 × 13]&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 567 more rows</span></span></span></code></pre>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>Changing the <code>value_cols</code> value</strong><br>
The <code>value_cols</code> parameter tells the function on which
numeric columns of x the functions should be applied. Note that every
function contained in <code>lambda</code> will be applied to every
column in <code>value_cols</code>: resulting columns will be named as
“original name_function applied”.</li>
</ol>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agg4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_values_by_key.html">aggregate_values_by_key</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">integration_matrices</span>,</span>
<span>    association_file <span class="op">=</span> <span class="va">association_file</span>,</span>
<span>    key <span class="op">=</span> <span class="st">"SubjectID"</span>,</span>
<span>    lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sum <span class="op">=</span> <span class="va">sum</span>, mean <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>,</span>
<span>    value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 577 × 10</span></span></span>
<span><span class="co">#&gt;    chr   integration_locus strand GeneName GeneStrand SubjectID seqCount_sum</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1               8<span style="text-decoration: underline;">464</span>757 -      RERE     -          PT001              543</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1               8<span style="text-decoration: underline;">607</span>357 +      RERE     -          PT001             <span style="text-decoration: underline;">1</span>427</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1               8<span style="text-decoration: underline;">607</span>362 -      RERE     -          PT001             <span style="text-decoration: underline;">1</span>702</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1               8<span style="text-decoration: underline;">850</span>362 +      RERE     -          PT002              562</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1              11<span style="text-decoration: underline;">339</span>120 +      UBIAD1   +          PT001             <span style="text-decoration: underline;">1</span>607</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1              12<span style="text-decoration: underline;">341</span>466 -      VPS13D   +          PT002             <span style="text-decoration: underline;">1</span>843</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1              14<span style="text-decoration: underline;">034</span>054 -      PRDM2    +          PT002             <span style="text-decoration: underline;">1</span>938</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1              16<span style="text-decoration: underline;">186</span>297 -      SPEN     +          PT001             <span style="text-decoration: underline;">3</span>494</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1              16<span style="text-decoration: underline;">602</span>483 +      FBXO42   -          PT001             <span style="text-decoration: underline;">2</span>947</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1              16<span style="text-decoration: underline;">602</span>483 +      FBXO42   -          PT002               30</span></span>
<span><span class="co">#&gt;    seqCount_mean fragmentEstimate_sum fragmentEstimate_mean</span></span>
<span><span class="co">#&gt;            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>          272.                 4.01                  2.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>          285.                40.1                   8.02</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>          851                  4.01                  2.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>          562                  3.01                  3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>          321.                10.0                   2.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         <span style="text-decoration: underline;">1</span>843                  8.05                  8.05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         <span style="text-decoration: underline;">1</span>938                  3.01                  3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>          699.                16.1                   3.22</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>          982.                 9.04                  3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>           30                  2.00                  2.00</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 567 more rows</span></span></span></code></pre>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>Changing the <code>group</code> value</strong><br>
The <code>group</code> parameter should contain all other variables to
include in the grouping besides <code>key</code>. By default this
contains
<code>c("chr", "integration_locus","strand", "GeneName", "GeneStrand")</code>.
You can change this grouping as you see fit, if you don’t want to add
any other variable to the key, just set it to <code>NULL</code>.</li>
</ol>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">agg5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aggregate_values_by_key.html">aggregate_values_by_key</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">integration_matrices</span>,</span>
<span>    association_file <span class="op">=</span> <span class="va">association_file</span>,</span>
<span>    key <span class="op">=</span> <span class="st">"SubjectID"</span>,</span>
<span>    lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sum <span class="op">=</span> <span class="va">sum</span>, mean <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/mandatory_IS_vars.html">mandatory_IS_vars</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 577 × 8</span></span></span>
<span><span class="co">#&gt;    chr   integration_locus strand SubjectID seqCount_sum seqCount_mean</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1               8<span style="text-decoration: underline;">464</span>757 -      PT001              543          272.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1               8<span style="text-decoration: underline;">607</span>357 +      PT001             <span style="text-decoration: underline;">1</span>427          285.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1               8<span style="text-decoration: underline;">607</span>362 -      PT001             <span style="text-decoration: underline;">1</span>702          851 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1               8<span style="text-decoration: underline;">850</span>362 +      PT002              562          562 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1              11<span style="text-decoration: underline;">339</span>120 +      PT001             <span style="text-decoration: underline;">1</span>607          321.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1              12<span style="text-decoration: underline;">341</span>466 -      PT002             <span style="text-decoration: underline;">1</span>843         <span style="text-decoration: underline;">1</span>843 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1              14<span style="text-decoration: underline;">034</span>054 -      PT002             <span style="text-decoration: underline;">1</span>938         <span style="text-decoration: underline;">1</span>938 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1              16<span style="text-decoration: underline;">186</span>297 -      PT001             <span style="text-decoration: underline;">3</span>494          699.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1              16<span style="text-decoration: underline;">602</span>483 +      PT001             <span style="text-decoration: underline;">2</span>947          982.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1              16<span style="text-decoration: underline;">602</span>483 +      PT002               30           30 </span></span>
<span><span class="co">#&gt;    fragmentEstimate_sum fragmentEstimate_mean</span></span>
<span><span class="co">#&gt;                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>                 4.01                  2.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>                40.1                   8.02</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>                 4.01                  2.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>                 3.01                  3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>                10.0                   2.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>                 8.05                  8.05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>                 3.01                  3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>                16.1                   3.22</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>                 9.04                  3.01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>                 2.00                  2.00</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 567 more rows</span></span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="reproducibility">Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"></a>
</h2>
<p><code>R</code> session information.</p>
<pre><code><span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">#&gt;  os       Ubuntu 20.04.5 LTS</span></span>
<span><span class="co">#&gt;  system   x86_64, linux-gnu</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  C.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    C.UTF-8</span></span>
<span><span class="co">#&gt;  tz       UTC</span></span>
<span><span class="co">#&gt;  date     2022-10-26</span></span>
<span><span class="co">#&gt;  pandoc   2.19.2 @ /usr/bin/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package     </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version</span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  backports      1.4.1   <span style="color: #555555;">2021-12-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  bibtex         0.5.0   <span style="color: #555555;">2022-09-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  BiocManager    1.30.19 <span style="color: #555555;">2022-10-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  BiocParallel   1.30.4  <span style="color: #555555;">2022-10-11</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  BiocStyle    * 2.24.0  <span style="color: #555555;">2022-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  bit            4.0.4   <span style="color: #555555;">2020-08-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  bit64          4.0.5   <span style="color: #555555;">2020-08-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  bookdown       0.29    <span style="color: #555555;">2022-09-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  bslib          0.4.0   <span style="color: #555555;">2022-07-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  cachem         1.0.6   <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  cellranger     1.1.0   <span style="color: #555555;">2016-07-27</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  cli            3.4.1   <span style="color: #555555;">2022-09-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  codetools      0.2-18  <span style="color: #555555;">2020-11-04</span> <span style="color: #555555;">[3]</span> <span style="color: #555555;">CRAN (R 4.2.1)</span></span></span>
<span><span class="co">#&gt;  colorspace     2.0-3   <span style="color: #555555;">2022-02-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  crayon         1.5.2   <span style="color: #555555;">2022-09-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  crosstalk      1.2.0   <span style="color: #555555;">2021-11-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  curl           4.3.3   <span style="color: #555555;">2022-10-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  data.table     1.14.4  <span style="color: #555555;">2022-10-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  datamods       1.3.4   <span style="color: #555555;">2022-09-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  desc           1.4.2   <span style="color: #555555;">2022-09-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  digest         0.6.30  <span style="color: #555555;">2022-10-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  doFuture       0.12.2  <span style="color: #555555;">2022-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  dplyr          1.0.10  <span style="color: #555555;">2022-09-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  DT           * 0.26    <span style="color: #555555;">2022-10-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ellipsis       0.3.2   <span style="color: #555555;">2021-04-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  evaluate       0.17    <span style="color: #555555;">2022-10-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  fansi          1.0.3   <span style="color: #555555;">2022-03-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  fastmap        1.1.0   <span style="color: #555555;">2021-01-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  forcats        0.5.2   <span style="color: #555555;">2022-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  foreach        1.5.2   <span style="color: #555555;">2022-02-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  foreign        0.8-82  <span style="color: #555555;">2022-01-16</span> <span style="color: #555555;">[3]</span> <span style="color: #555555;">CRAN (R 4.2.1)</span></span></span>
<span><span class="co">#&gt;  fs             1.5.2   <span style="color: #555555;">2021-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  future         1.28.0  <span style="color: #555555;">2022-09-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  generics       0.1.3   <span style="color: #555555;">2022-07-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ggplot2        3.3.6   <span style="color: #555555;">2022-05-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  globals        0.16.1  <span style="color: #555555;">2022-08-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  glue           1.6.2   <span style="color: #555555;">2022-02-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  gtable         0.3.1   <span style="color: #555555;">2022-09-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  haven          2.5.1   <span style="color: #555555;">2022-08-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  highr          0.9     <span style="color: #555555;">2021-04-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  hms            1.1.2   <span style="color: #555555;">2022-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  htmltools      0.5.3   <span style="color: #555555;">2022-07-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  htmlwidgets    1.5.4   <span style="color: #555555;">2021-09-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  httpuv         1.6.6   <span style="color: #555555;">2022-09-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  httr           1.4.4   <span style="color: #555555;">2022-08-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ISAnalytics  * 1.7.7   <span style="color: #555555;">2022-10-26</span> <span style="color: #555555;">[1]</span> <span style="color: #555555;">Bioconductor</span></span></span>
<span><span class="co">#&gt;  iterators      1.0.14  <span style="color: #555555;">2022-02-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  jquerylib      0.1.4   <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  jsonlite       1.8.3   <span style="color: #555555;">2022-10-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  knitr          1.40    <span style="color: #555555;">2022-08-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  later          1.3.0   <span style="color: #555555;">2021-08-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  lattice        0.20-45 <span style="color: #555555;">2021-09-22</span> <span style="color: #555555;">[3]</span> <span style="color: #555555;">CRAN (R 4.2.1)</span></span></span>
<span><span class="co">#&gt;  lifecycle      1.0.3   <span style="color: #555555;">2022-10-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  listenv        0.8.0   <span style="color: #555555;">2019-12-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  lubridate      1.8.0   <span style="color: #555555;">2021-10-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  magrittr     * 2.0.3   <span style="color: #555555;">2022-03-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  memoise        2.0.1   <span style="color: #555555;">2021-11-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  mime           0.12    <span style="color: #555555;">2021-09-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  mnormt         2.1.1   <span style="color: #555555;">2022-09-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  munsell        0.5.0   <span style="color: #555555;">2018-06-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  nlme           3.1-157 <span style="color: #555555;">2022-03-25</span> <span style="color: #555555;">[3]</span> <span style="color: #555555;">CRAN (R 4.2.1)</span></span></span>
<span><span class="co">#&gt;  openxlsx       4.2.5.1 <span style="color: #555555;">2022-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  parallelly     1.32.1  <span style="color: #555555;">2022-07-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pillar         1.8.1   <span style="color: #555555;">2022-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pkgconfig      2.0.3   <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pkgdown        2.0.6   <span style="color: #555555;">2022-07-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">any (@2.0.6)</span></span></span>
<span><span class="co">#&gt;  plyr           1.8.7   <span style="color: #555555;">2022-03-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  progressr      0.11.0  <span style="color: #555555;">2022-09-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  promises       1.2.0.1 <span style="color: #555555;">2021-02-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  psych          2.2.9   <span style="color: #555555;">2022-09-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  purrr          0.3.5   <span style="color: #555555;">2022-10-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  R.methodsS3    1.8.2   <span style="color: #555555;">2022-06-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  R.oo           1.25.0  <span style="color: #555555;">2022-06-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  R.utils        2.12.0  <span style="color: #555555;">2022-06-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  R6             2.5.1   <span style="color: #555555;">2021-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ragg           1.2.4   <span style="color: #555555;">2022-10-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  Rcapture       1.4-4   <span style="color: #555555;">2022-05-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  Rcpp           1.0.9   <span style="color: #555555;">2022-07-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  readr          2.1.3   <span style="color: #555555;">2022-10-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  readxl         1.4.1   <span style="color: #555555;">2022-08-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  RefManageR   * 1.4.0   <span style="color: #555555;">2022-09-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rio            0.5.29  <span style="color: #555555;">2021-11-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rlang          1.0.6   <span style="color: #555555;">2022-09-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rmarkdown      2.17    <span style="color: #555555;">2022-10-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rprojroot      2.0.3   <span style="color: #555555;">2022-04-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  sass           0.4.2   <span style="color: #555555;">2022-07-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  scales         1.2.1   <span style="color: #555555;">2022-08-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  sessioninfo  * 1.2.2   <span style="color: #555555;">2021-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">any (@1.2.2)</span></span></span>
<span><span class="co">#&gt;  shiny          1.7.3   <span style="color: #555555;">2022-10-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  shinyWidgets   0.7.4   <span style="color: #555555;">2022-10-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  stringi        1.7.8   <span style="color: #555555;">2022-07-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  stringr        1.4.1   <span style="color: #555555;">2022-08-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  systemfonts    1.0.4   <span style="color: #555555;">2022-02-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  textshaping    0.3.6   <span style="color: #555555;">2021-10-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  tibble         3.1.8   <span style="color: #555555;">2022-07-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  tidyr          1.2.1   <span style="color: #555555;">2022-09-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  tidyselect     1.2.0   <span style="color: #555555;">2022-10-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  tzdb           0.3.0   <span style="color: #555555;">2022-03-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  utf8           1.2.2   <span style="color: #555555;">2021-07-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  vctrs          0.5.0   <span style="color: #555555;">2022-10-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  vroom          1.6.0   <span style="color: #555555;">2022-09-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  withr          2.5.0   <span style="color: #555555;">2022-03-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  xfun           0.34    <span style="color: #555555;">2022-10-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  xml2           1.3.3   <span style="color: #555555;">2021-11-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  xtable         1.8-4   <span style="color: #555555;">2019-04-21</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  yaml           2.3.6   <span style="color: #555555;">2022-10-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  zip            2.2.1   <span style="color: #555555;">2022-09-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /home/runner/work/_temp/Library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /opt/R/4.2.1/lib/R/site-library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [3] /opt/R/4.2.1/lib/R/library</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<p>This vignette was generated using <em><a href="https://bioconductor.org/packages/3.15/BiocStyle" class="external-link">BiocStyle</a></em>
(Oleś, 2022) with <em><a href="https://CRAN.R-project.org/package=knitr" class="external-link">knitr</a></em> (Xie,
2022) and <em><a href="https://CRAN.R-project.org/package=rmarkdown" class="external-link">rmarkdown</a></em>
(Allaire, Xie, McPherson, Luraschi, Ushey, Atkins, Wickham, Cheng,
Chang, and Iannone, 2022) running behind the scenes.</p>
<p>Citations made with <em><a href="https://CRAN.R-project.org/package=RefManageR" class="external-link">RefManageR</a></em>
(McLean, 2017).</p>
<p>
<a id="bib-allaire2022rmarkdown"></a><a href="#cite-allaire2022rmarkdown">[1]</a><cite>
J. Allaire, Y. Xie, J. McPherson, et al. <em>rmarkdown: Dynamic
Documents for R</em>. R package version 2.17. 2022. URL:
<a href="https://github.com/rstudio/rmarkdown" class="external-link">https://github.com/rstudio/rmarkdown</a>.</cite>
</p>
<p>
<a id="bib-giuliospinozzivispa2"></a><a href="#cite-giuliospinozzivispa2">[2]</a><cite>
S. B. Giulio Spinozzi Andrea Calabria. “VISPA2: a scalable pipeline for
high-throughput identification and annotation of vector integration
sites”. In: <em>BMC Bioinformatics</em> (Nov. 25, 2017). DOI:
<a href="https://doi.org/10.1186/s12859-017-1937-9" class="external-link">10.1186/s12859-017-1937-9</a>.</cite>
</p>
<p>
<a id="bib-mclean2017refmanager"></a><a href="#cite-mclean2017refmanager">[3]</a><cite>
M. W. McLean. “RefManageR: Import and Manage BibTeX and BibLaTeX
References in R”. In: <em>The Journal of Open Source Software</em>
(2017). DOI:
<a href="https://doi.org/10.21105/joss.00338" class="external-link">10.21105/joss.00338</a>.</cite>
</p>
<p>
<a id="bib-ole2022biocstyle"></a><a href="#cite-ole2022biocstyle">[4]</a><cite>
A. Oleś. <em>BiocStyle: Standard styles for vignettes and other
Bioconductor documents</em>. R package version 2.24.0. 2022. URL:
<a href="https://github.com/Bioconductor/BiocStyle" class="external-link">https://github.com/Bioconductor/BiocStyle</a>.</cite>
</p>
<p>
<a id="bib-xie2022knitr"></a><a href="#cite-xie2022knitr">[5]</a><cite>
Y. Xie. <em>knitr: A General-Purpose Package for Dynamic Report
Generation in R</em>. R package version 1.40. 2022. URL:
<a href="https://yihui.org/knitr/" class="external-link">https://yihui.org/knitr/</a>.</cite>
</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Andrea Calabria, Giulio Spinozzi, Giulia Pais.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

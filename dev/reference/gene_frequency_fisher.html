<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
Provided 2 data frames with calculations for CIS, via CIS_grubbs(),
computes Fisher's exact test.
Results can be plotted via fisher_scatterplot()."><title>Compute Fisher's exact test on gene frequencies. — gene_frequency_fisher • ISAnalytics</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Fisher's exact test on gene frequencies. — gene_frequency_fisher"><meta property="og:description" content="
Provided 2 data frames with calculations for CIS, via CIS_grubbs(),
computes Fisher's exact test.
Results can be plotted via fisher_scatterplot()."><meta property="og:image" content="https://calabrialab.github.io/ISAnalytics/logo.png"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ISAnalytics</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.7.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/ISAnalytics.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/workflow_start.html">Setting up the workflow and first steps</a>
    <a class="dropdown-item" href="../articles/sharing_analyses.html">Sharing analyses with ISAnalytics</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="https://calabrialab.github.io/ISAnalytics/">
    <span class="fas fa fas fa-code-branch"></span>
     
    RELEASE
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/calabrialab/ISAnalytics/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute Fisher's exact test on gene frequencies.</h1>
      <small class="dont-index">Source: <a href="https://github.com/calabrialab/ISAnalytics/blob/HEAD/R/analysis-functions.R" class="external-link"><code>R/analysis-functions.R</code></a></small>
      <div class="d-none name"><code>gene_frequency_fisher.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
Provided 2 data frames with calculations for CIS, via <code><a href="CIS_grubbs.html">CIS_grubbs()</a></code>,
computes Fisher's exact test.
Results can be plotted via <code><a href="fisher_scatterplot.html">fisher_scatterplot()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">gene_frequency_fisher</span><span class="op">(</span>
  <span class="va">cis_x</span>,
  <span class="va">cis_y</span>,
  min_is_per_gene <span class="op">=</span> <span class="fl">3</span>,
  gene_set_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intersection"</span>, <span class="st">"union"</span><span class="op">)</span>,
  onco_db_file <span class="op">=</span> <span class="st">"proto_oncogenes"</span>,
  tumor_suppressors_db_file <span class="op">=</span> <span class="st">"tumor_suppressors"</span>,
  species <span class="op">=</span> <span class="st">"human"</span>,
  known_onco <span class="op">=</span> <span class="fu"><a href="known_clinical_oncogenes.html">known_clinical_oncogenes</a></span><span class="op">(</span><span class="op">)</span>,
  suspicious_genes <span class="op">=</span> <span class="fu"><a href="clinical_relevant_suspicious_genes.html">clinical_relevant_suspicious_genes</a></span><span class="op">(</span><span class="op">)</span>,
  significance_threshold <span class="op">=</span> <span class="fl">0.05</span>,
  remove_unbalanced_0 <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>cis_x</dt>
<dd><p>A data frame obtained via <code><a href="CIS_grubbs.html">CIS_grubbs()</a></code></p></dd>
<dt>cis_y</dt>
<dd><p>A data frame obtained via <code><a href="CIS_grubbs.html">CIS_grubbs()</a></code></p></dd>
<dt>min_is_per_gene</dt>
<dd><p>Used for pre-filtering purposes. Genes with a
number of distinct integration less than this number will be filtered out
prior calculations. Single numeric or integer.</p></dd>
<dt>gene_set_method</dt>
<dd><p>One between "intersection" and "union". When merging
the 2 data frames, <code>intersection</code> will perform an inner join operation,
while <code>union</code> will perform a full join operation.</p></dd>
<dt>onco_db_file</dt>
<dd><p>Uniprot file for proto-oncogenes (see details).
If different from default, should be supplied as a path to a file.</p></dd>
<dt>tumor_suppressors_db_file</dt>
<dd><p>Uniprot file for tumor-suppressor genes.
If different from default, should be supplied as a path to a file.</p></dd>
<dt>species</dt>
<dd><p>One between <code>"human"</code>, <code>"mouse"</code> and <code>"all"</code></p></dd>
<dt>known_onco</dt>
<dd><p>Data frame with known oncogenes. See details.</p></dd>
<dt>suspicious_genes</dt>
<dd><p>Data frame with clinical relevant suspicious
genes. See details.</p></dd>
<dt>significance_threshold</dt>
<dd><p>Significance threshold for the Fisher's
test p-value</p></dd>
<dt>remove_unbalanced_0</dt>
<dd><p>Remove from the final output those pairs in
which there are no IS for one group or the other and the number of
IS of the non-missing group are less than the mean number of IS for that
group</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
<div class="section">
<h3 id="oncogene-and-tumor-suppressor-genes-files">Oncogene and tumor suppressor genes files<a class="anchor" aria-label="anchor" href="#oncogene-and-tumor-suppressor-genes-files"></a></h3>


<p>These files are included in the package for user convenience and are
simply UniProt files with gene annotations for human and mouse.
For more details on how this files were generated use the help
<code><a href="proto_oncogenes.html">?tumor_suppressors</a></code>, <code><a href="proto_oncogenes.html">?proto_oncogenes</a></code></p>
</div>

<div class="section">
<h3 id="known-oncogenes">Known oncogenes<a class="anchor" aria-label="anchor" href="#known-oncogenes"></a></h3>


<p>The default values are included in this package and
it can be accessed by doing:</p><div class="sourceCode r"><pre><code><span class="fu"><a href="../reference/known_clinical_oncogenes.html">known_clinical_oncogenes</a></span><span class="op">(</span><span class="op">)</span></code></pre><p></p></div>
<p>If the user wants to change this parameter the input data frame must
preserve the column structure. The same goes for the <code>suspicious_genes</code>
parameter (DOIReference column is optional):</p><div class="sourceCode r"><pre><code><span class="fu"><a href="../reference/clinical_relevant_suspicious_genes.html">clinical_relevant_suspicious_genes</a></span><span class="op">(</span><span class="op">)</span></code></pre><p></p></div>
</div>

    </div>
    <div class="section level2">
    <h2 id="required-tags">Required tags<a class="anchor" aria-label="anchor" href="#required-tags"></a></h2>
    

<p>The function will explicitly check for the presence of these tags:
*</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Analysis functions: 
<code><a href="CIS_grubbs.html">CIS_grubbs</a>()</code>,
<code><a href="HSC_population_size_estimate.html">HSC_population_size_estimate</a>()</code>,
<code><a href="compute_abundance.html">compute_abundance</a>()</code>,
<code><a href="cumulative_is.html">cumulative_is</a>()</code>,
<code><a href="is_sharing.html">is_sharing</a>()</code>,
<code><a href="iss_source.html">iss_source</a>()</code>,
<code><a href="sample_statistics.html">sample_statistics</a>()</code>,
<code><a href="top_integrations.html">top_integrations</a>()</code>,
<code><a href="top_targeted_genes.html">top_targeted_genes</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"integration_matrices"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"association_file"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">aggreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate_values_by_key.html">aggregate_values_by_key</a></span><span class="op">(</span></span>
<span class="r-in">    x <span class="op">=</span> <span class="va">integration_matrices</span>,</span>
<span class="r-in">    association_file <span class="op">=</span> <span class="va">association_file</span>,</span>
<span class="r-in">    value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">cis</span> <span class="op">&lt;-</span> <span class="fu"><a href="CIS_grubbs.html">CIS_grubbs</a></span><span class="op">(</span><span class="va">aggreg</span>, by <span class="op">=</span> <span class="st">"SubjectID"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Warning: missing genes in refgenes table</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> A total of 5 genes were found in the input data but not in the refgene table. This may be caused by a mismatch in the annotation phase of the matrix. Here is a summary: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 5 × 3</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   GeneName  GeneStrand chr  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> CRELD2    -          15   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> HTR4      +          6    </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> LINC01133 +          19   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> PLEKHG4B  -          14   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> UBE2D2    +          16   </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> NOTE: missing genes will be removed from the final output! Review results carefully</span>
<span class="r-in"><span class="va">fisher</span> <span class="op">&lt;-</span> <span class="fu">gene_frequency_fisher</span><span class="op">(</span><span class="va">cis</span><span class="op">$</span><span class="va">cis</span><span class="op">$</span><span class="va">PT001</span>, <span class="va">cis</span><span class="op">$</span><span class="va">cis</span><span class="op">$</span><span class="va">PT002</span>,</span>
<span class="r-in">    min_is_per_gene <span class="op">=</span> <span class="fl">2</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">fisher</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 27</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GeneName n_IS_perGene_1 average_TxLen_1 raw_gene_integration_freque… Onco1_TS2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> KMT5B                 2          <span style="text-decoration: underline;">54</span>306.                    0.000<span style="text-decoration: underline;">036</span>8        <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 22 more variables: ClinicalRelevance &lt;lgl&gt;, DOIReference &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   KnownGeneClass &lt;chr&gt;, KnownClonalExpansion &lt;lgl&gt;, CriticalForInsMut &lt;lgl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   IS_per_kbGeneLen_1 &lt;dbl&gt;, Sum_IS_per_kbGeneLen_1 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   IS_per_kbGeneLen_perMDepth_TPM_1 &lt;dbl&gt;, n_IS_perGene_2 &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   average_TxLen_2 &lt;dbl&gt;, raw_gene_integration_frequency_2 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   IS_per_kbGeneLen_2 &lt;dbl&gt;, Sum_IS_per_kbGeneLen_2 &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   IS_per_kbGeneLen_perMDepth_TPM_2 &lt;dbl&gt;, tot_n_IS_perGene_1 &lt;int&gt;, …</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Andrea Calabria, Giulio Spinozzi, Giulia Pais.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>


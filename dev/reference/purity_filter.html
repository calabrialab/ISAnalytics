<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Filter integration sites based on purity. — purity_filter • ISAnalytics</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Filter integration sites based on purity. — purity_filter" />
<meta property="og:description" content="

Filter that targets possible contamination between cell lines based on
a numeric quantification (likely abundance or sequence count)." />
<meta property="og:image" content="https://calabrialab.github.io/ISAnalytics/logo.png" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ISAnalytics</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.3.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/aggregate_function_usage.html">Working with aggregate functions</a>
    </li>
    <li>
      <a href="../articles/collision_removal.html">Collision removal functionality</a>
    </li>
    <li>
      <a href="../articles/how_to_import_functions.html">How to use import functions</a>
    </li>
    <li>
      <a href="../articles/sharing_analyses.html">Sharing analyses with ISAnalytics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://calabrialab.github.io/ISAnalytics/">
    <span class="fas fa-code-branch"></span>
     
    RELEASE
  </a>
</li>
<li>
  <a href="https://github.com/calabrialab/ISAnalytics/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter integration sites based on purity.</h1>
    <small class="dont-index">Source: <a href='https://github.com/calabrialab/ISAnalytics/blob/master/R/analysis-functions.R'><code>R/analysis-functions.R</code></a></small>
    <div class="hidden name"><code>purity_filter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href='https://lifecycle.r-lib.org/articles/stages.html#experimental'><img src='figures/lifecycle-experimental.svg' alt='[Experimental]' /></a>

Filter that targets possible contamination between cell lines based on
a numeric quantification (likely abundance or sequence count).</p>
    </div>

    <pre class="usage"><span class='fu'>purity_filter</span><span class='op'>(</span>
  <span class='va'>x</span>,
  lineages <span class='op'>=</span> <span class='fu'><a href='blood_lineages_default.html'>blood_lineages_default</a></span><span class='op'>(</span><span class='op'>)</span>,
  aggregation_key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SubjectID"</span>, <span class='st'>"CellMarker"</span>, <span class='st'>"Tissue"</span>, <span class='st'>"TimePoint"</span><span class='op'>)</span>,
  group_key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CellMarker"</span>, <span class='st'>"Tissue"</span><span class='op'>)</span>,
  selected_groups <span class='op'>=</span> <span class='cn'>NULL</span>,
  join_on <span class='op'>=</span> <span class='st'>"CellMarker"</span>,
  min_value <span class='op'>=</span> <span class='fl'>3</span>,
  impurity_threshold <span class='op'>=</span> <span class='fl'>10</span>,
  by_timepoint <span class='op'>=</span> <span class='cn'>TRUE</span>,
  timepoint_column <span class='op'>=</span> <span class='st'>"TimePoint"</span>,
  value_column <span class='op'>=</span> <span class='st'>"seqCount_sum"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An aggregated integration matrix, obtained via
<code><a href='aggregate_values_by_key.html'>aggregate_values_by_key()</a></code></p></td>
    </tr>
    <tr>
      <th>lineages</th>
      <td><p>A data frame containing cell lineages information</p></td>
    </tr>
    <tr>
      <th>aggregation_key</th>
      <td><p>The key used for aggregating <code>x</code></p></td>
    </tr>
    <tr>
      <th>group_key</th>
      <td><p>A character vector of column names for re-aggregation.
Column names must be either in <code>x</code> or in <code>lineages</code>. See details.</p></td>
    </tr>
    <tr>
      <th>selected_groups</th>
      <td><p>Either NULL, a character vector or a
data frame for group selection. See details.</p></td>
    </tr>
    <tr>
      <th>join_on</th>
      <td><p>Common columns to perform a join operation on</p></td>
    </tr>
    <tr>
      <th>min_value</th>
      <td><p>A minimum value to filter the input matrix. Integrations
with a value strictly lower than <code>min_value</code> are excluded (dropped) from
the output.</p></td>
    </tr>
    <tr>
      <th>impurity_threshold</th>
      <td><p>The ratio threshold for impurity in groups</p></td>
    </tr>
    <tr>
      <th>by_timepoint</th>
      <td><p>Should filtering be applied on each time point? If
<code>FALSE</code>, all time points are merged together</p></td>
    </tr>
    <tr>
      <th>timepoint_column</th>
      <td><p>Column in <code>x</code> containing the time point</p></td>
    </tr>
    <tr>
      <th>value_column</th>
      <td><p>Column in <code>x</code> containing the numeric
quantification of interest</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Setting input arguments</h3>


<p>The input matrix can be re-aggregated with the provided <code>group_key</code>
argument. This key contains the names of the columns to group on
(besides the columns holding genomic coordinates of the integration
sites) and must be contained in at least one of <code>x</code> or <code>lineages</code>
data frames. If the key is not found only in <code>x</code>, then a join operation
with the <code>lineages</code> data frame is performed on the common column(s)
<code>join_on</code>.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Group selection</h3>


<p>It is possible for the user to specify on which groups the logic of the
filter should be applied to. For example: if we have
<code>group_key = c("HematoLineage")</code> and we set
<code>selected_groups = c("CD34", "Myeloid","Lymphoid")</code>
it means that a single integration will be evaluated for the filter only
for groups that have the values of "CD34", "Myeloid" and "Lymphoid" in
the "HematoLineage" column.
If the same integration is present in other groups it is
kept as it is. <code>selected_groups</code> can be set to <code>NULL</code> if we want
the logic to apply to every group present in the data frame,
it can be set as a simple character vector as the example above if
the group key has length 1 (and there is no need to filter on time point).
If the group key is longer than 1 then the filter is applied only on the
first element of the key.</p>
<p>If a more refined selection on groups is needed, a data frame can
be provided instead:</p><pre><span class='va'>group_key</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CellMarker"</span>, <span class='st'>"Tissue"</span><span class='op'>)</span>
<span class='va'>selected_groups</span> <span class='op'>=</span> <span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tribble.html'>tribble</a></span><span class='op'>(</span>
<span class='op'>~</span> <span class='va'>CellMarker</span>, <span class='op'>~</span> <span class='va'>Tissue</span>,
<span class='st'>"CD34"</span>, <span class='st'>"BM"</span>,
<span class='st'>"CD14"</span>, <span class='st'>"BM"</span>,
<span class='st'>"CD14"</span>, <span class='st'>"PB"</span>
<span class='op'>)</span>
</pre>

<p>Columns in the data frame should be the same as group key (plus,
eventually, the time point column). In this example only those groups
identified by the rows in the provided data frame are processed.</p>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other Analysis functions: 
<code><a href='CIS_grubbs.html'>CIS_grubbs</a>()</code>,
<code><a href='comparison_matrix.html'>comparison_matrix</a>()</code>,
<code><a href='compute_abundance.html'>compute_abundance</a>()</code>,
<code><a href='cumulative_count_union.html'>cumulative_count_union</a>()</code>,
<code><a href='cumulative_is.html'>cumulative_is</a>()</code>,
<code><a href='is_sharing.html'>is_sharing</a>()</code>,
<code><a href='iss_source.html'>iss_source</a>()</code>,
<code><a href='sample_statistics.html'>sample_statistics</a>()</code>,
<code><a href='separate_quant_matrices.html'>separate_quant_matrices</a>()</code>,
<code><a href='threshold_filter.html'>threshold_filter</a>()</code>,
<code><a href='top_integrations.html'>top_integrations</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"integration_matrices"</span>, package <span class='op'>=</span> <span class='st'>"ISAnalytics"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"association_file"</span>, package <span class='op'>=</span> <span class='st'>"ISAnalytics"</span><span class='op'>)</span>
<span class='va'>aggreg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='aggregate_values_by_key.html'>aggregate_values_by_key</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>integration_matrices</span>,
    association_file <span class='op'>=</span> <span class='va'>association_file</span>,
    value_cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"seqCount"</span>, <span class='st'>"fragmentEstimate"</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>filtered_by_purity</span> <span class='op'>&lt;-</span> <span class='fu'>purity_filter</span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>aggreg</span>,
    value_column <span class='op'>=</span> <span class='st'>"seqCount_sum"</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>filtered_by_purity</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 6 × 9</span>
#&gt;   chr   integration_locus strand GeneName GeneStrand TimePoint CellMarker Tissue
#&gt;   <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>             <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>      <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>     <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>      <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> 
#&gt; <span style='color: #BCBCBC;'>1</span> 1              27<span style='text-decoration: underline;'>058</span>748 -      ARID1A   +          0060      MNC        BM    
#&gt; <span style='color: #BCBCBC;'>2</span> 1              89<span style='text-decoration: underline;'>337</span>032 +      GTF2B    -          0360      MNC        BM    
#&gt; <span style='color: #BCBCBC;'>3</span> 1              89<span style='text-decoration: underline;'>337</span>032 +      GTF2B    -          0360      MNC        PB    
#&gt; <span style='color: #BCBCBC;'>4</span> 10             74<span style='text-decoration: underline;'>765</span>793 -      P4HA1    -          0360      MNC        BM    
#&gt; <span style='color: #BCBCBC;'>5</span> 10             74<span style='text-decoration: underline;'>765</span>793 -      P4HA1    -          0360      MNC        PB    
#&gt; <span style='color: #BCBCBC;'>6</span> 11              3<span style='text-decoration: underline;'>899</span>973 +      STIM1    +          0090      MNC        BM    
#&gt; <span style='color: #949494;'># … with 1 more variable: Value &lt;dbl&gt;</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andrea Calabria, Giulio Spinozzi, Giulia Pais.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
This function computes the visualization of the results of the function
CIS_grubbs_overtime() in the form of heatmaps for the top N selected
genes over time."><title>Heatmaps for the top N common insertion sites over time. — top_cis_overtime_heatmap • ISAnalytics</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Heatmaps for the top N common insertion sites over time. — top_cis_overtime_heatmap"><meta property="og:description" content="
This function computes the visualization of the results of the function
CIS_grubbs_overtime() in the form of heatmaps for the top N selected
genes over time."><meta property="og:image" content="https://calabrialab.github.io/ISAnalytics/logo.png"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ISAnalytics</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.8.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/ISAnalytics.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/workflow_start.html">Setting up the workflow and first steps</a>
    <a class="dropdown-item" href="../articles/sharing_analyses.html">Sharing analyses with ISAnalytics</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="https://calabrialab.github.io/ISAnalytics/">
    <span class="fas fa fas fa-code-branch"></span>
     
    RELEASE
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/calabrialab/ISAnalytics/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Heatmaps for the top N common insertion sites over time.</h1>
      <small class="dont-index">Source: <a href="https://github.com/calabrialab/ISAnalytics/blob/HEAD/R/plotting-functions.R" class="external-link"><code>R/plotting-functions.R</code></a></small>
      <div class="d-none name"><code>top_cis_overtime_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
This function computes the visualization of the results of the function
<code><a href="CIS_grubbs_overtime.html">CIS_grubbs_overtime()</a></code> in the form of heatmaps for the top N selected
genes over time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">top_cis_overtime_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  n_genes <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  timepoint_col <span class="op">=</span> <span class="st">"TimePoint"</span>,</span>
<span>  group_col <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  onco_db_file <span class="op">=</span> <span class="st">"proto_oncogenes"</span>,</span>
<span>  tumor_suppressors_db_file <span class="op">=</span> <span class="st">"tumor_suppressors"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"human"</span>,</span>
<span>  known_onco <span class="op">=</span> <span class="fu"><a href="known_clinical_oncogenes.html">known_clinical_oncogenes</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  suspicious_genes <span class="op">=</span> <span class="fu"><a href="clinical_relevant_suspicious_genes.html">clinical_relevant_suspicious_genes</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  significance_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  plot_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"minus_log_p"</span>, <span class="st">"p"</span><span class="op">)</span>,</span>
<span>  p_value_correction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fdr"</span>, <span class="st">"bonferroni"</span><span class="op">)</span>,</span>
<span>  prune_tp_treshold <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  gene_selection_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trimmed"</span>, <span class="st">"n"</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"median"</span>, <span class="st">"mad"</span>, <span class="st">"min"</span>, <span class="st">"max"</span><span class="op">)</span>,</span>
<span>  fill_0_selection <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fill_NA_in_heatmap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  heatmap_color_palette <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  title_generator <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_as_files <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  files_format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pdf"</span>, <span class="st">"png"</span>, <span class="st">"tiff"</span>, <span class="st">"bmp"</span>, <span class="st">"jpg"</span><span class="op">)</span>,</span>
<span>  folder_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Output of the function <code><a href="CIS_grubbs_overtime.html">CIS_grubbs_overtime()</a></code>, either in single
data frame form or nested lists</p></dd>


<dt>n_genes</dt>
<dd><p>Number of top genes to consider</p></dd>


<dt>timepoint_col</dt>
<dd><p>The name of the time point column in <code>x</code></p></dd>


<dt>group_col</dt>
<dd><p>The name of the group column in <code>x</code></p></dd>


<dt>onco_db_file</dt>
<dd><p>Uniprot file for proto-oncogenes (see details).
If different from default, should be supplied as a path to a file.</p></dd>


<dt>tumor_suppressors_db_file</dt>
<dd><p>Uniprot file for tumor-suppressor genes.
If different from default, should be supplied as a path to a file.</p></dd>


<dt>species</dt>
<dd><p>One between <code>"human"</code>, <code>"mouse"</code> and <code>"all"</code></p></dd>


<dt>known_onco</dt>
<dd><p>Data frame with known oncogenes. See details.</p></dd>


<dt>suspicious_genes</dt>
<dd><p>Data frame with clinical relevant suspicious
genes. See details.</p></dd>


<dt>significance_threshold</dt>
<dd><p>The significance threshold</p></dd>


<dt>plot_values</dt>
<dd><p>Which kind of values should be plotted? Can either be
<code>"p"</code> for the p-value or <code>"minus_log_p"</code> for a scaled p-value of the
Grubbs test</p></dd>


<dt>p_value_correction</dt>
<dd><p>One among <code>"bonferroni"</code> and <code>"fdr"</code></p></dd>


<dt>prune_tp_treshold</dt>
<dd><p>Minimum number of genes to retain a time point.
See details.</p></dd>


<dt>gene_selection_param</dt>
<dd><p>The descriptive statistic measure to decide
which genes to plot, possible choices are
<code>"trimmed", "n", "mean", "sd", "median","mad", "min", "max"</code>. See details.</p></dd>


<dt>fill_0_selection</dt>
<dd><p>Fill NA values with 0s before computing statistics
for each gene? (TRUE/FALSE)</p></dd>


<dt>fill_NA_in_heatmap</dt>
<dd><p>Fill NA values with 0 when plotting the heatmap?
(TRUE/FALSE)</p></dd>


<dt>heatmap_color_palette</dt>
<dd><p>Colors for values in the heatmaps,
either <code>"default"</code> or a function producing
a color palette, obtainable via <code><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">grDevices::colorRampPalette</a></code>.</p></dd>


<dt>title_generator</dt>
<dd><p>Either <code>NULL</code> or a function. See details.</p></dd>


<dt>save_as_files</dt>
<dd><p>Should heatmaps be saved to files on disk? (TRUE/FALSE)</p></dd>


<dt>files_format</dt>
<dd><p>The extension of the files produced, supported
formats are <code>"pdf", "png", "tiff", "bmp", "jpg"</code>. Relevant only if
<code>files_format = TRUE</code></p></dd>


<dt>folder_path</dt>
<dd><p>Path to the folder where files will be saved</p></dd>


<dt>...</dt>
<dd><p>Other params to pass to <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap::pheatmap</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Either a list of graphical objects or a list of paths where
plots were saved</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
<div class="section">
<h3 id="oncogene-and-tumor-suppressor-genes-files">Oncogene and tumor suppressor genes files<a class="anchor" aria-label="anchor" href="#oncogene-and-tumor-suppressor-genes-files"></a></h3>


<p>These files are included in the package for user convenience and are
simply UniProt files with gene annotations for human and mouse.
For more details on how this files were generated use the help
<code><a href="proto_oncogenes.html">?tumor_suppressors</a></code>, <code><a href="proto_oncogenes.html">?proto_oncogenes</a></code></p>
</div>

<div class="section">
<h3 id="known-oncogenes">Known oncogenes<a class="anchor" aria-label="anchor" href="#known-oncogenes"></a></h3>


<p>The default values are included in this package and
it can be accessed by doing:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/known_clinical_oncogenes.html">known_clinical_oncogenes</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre><p></p></div>
<p>If the user wants to change this parameter the input data frame must
preserve the column structure. The same goes for the <code>suspicious_genes</code>
parameter (DOIReference column is optional):</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/clinical_relevant_suspicious_genes.html">clinical_relevant_suspicious_genes</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre><p></p></div>
</div>

<div class="section">
<h3 id="top-n-gene-selection">Top N gene selection<a class="anchor" aria-label="anchor" href="#top-n-gene-selection"></a></h3>


<p>Since the genes present in different time point slices are likely different,
the decision process to select the final top N genes to represent in the
heatmap follows this logic:</p><ul><li><p>Each time point slice is arranged either in ascending order (if we want to
plot the p-value) or in descending order (if we want to plot the scaled
p-value) and the top n genes are selected</p></li>
<li><p>A series of statistics are computed over the union set of genes on ALL
time points (min, max, mean, ...)</p></li>
<li><p>A decision is taken by considering the ordered <code>gene_selection_param</code>
(order depends once again if the values are scaled or not), and the first
N genes are selected for plotting.</p></li>
</ul><div class="section">
<h4 id="filling-na-values-prior-calculations">Filling NA values prior calculations<a class="anchor" aria-label="anchor" href="#filling-na-values-prior-calculations"></a></h4>


<p>It is possible to fill NA values (aka missing combinations of GENE/TP) with
0s prior computing the descriptive statistics on which gene selection is
based. Please keep in mind that this has an impact on the final result,
since for computing metrics such as the mean, NA values are usually removed,
decreasing the overall number of values considered - this does not hold
when NA values are substituted with 0s.</p>
</div>

<div class="section">
<h4 id="the-statistics">The statistics<a class="anchor" aria-label="anchor" href="#the-statistics"></a></h4>


<p>Statistics are computed for each gene over all time points of each group.
More in detail, <code>n</code>: counts the number of instances (rows)
in which the genes appears, aka it counts the time points in which the gene
is present. NOTE: if
<code>fill_0_selection</code> option is set to <code>TRUE</code> this value will be equal for
all genes! All other statistics as per the argument <code>gene_selection_param</code>
map to the corresponding R functions with the exception of <code>trimmed</code> which
is a simple call to the <code>mean</code> function with the argument <code>trimmed = 0.1</code>.</p>
</div>


</div>

<div class="section">
<h3 id="aesthetics">Aesthetics<a class="anchor" aria-label="anchor" href="#aesthetics"></a></h3>


<p>It is possible to customise the appearence of the plot through different
parameters.</p><ul><li><p><code>fill_NA_in_heatmap</code> tells the function whether missing combinations of
GENE/TP should be plotted as NA or filled with a value (1 if p-value, 0
if scaled p-value)</p></li>
<li><p>A title generator function can be provided to dynamically create a title
for the plots: the function can accept two positional arguments for
the group identifier and the number of selected genes respectively. If one or
none of the arguments are of interest, they can be absorbed with <code>...</code>.</p></li>
<li><p><code>heatmap_color_palette</code> can be used to specify a function from which
colors are sampled (refers to the colors of values only)</p></li>
<li><p>To change the colors associated with annotations instead, use the
argument <code>annotation_colors</code> of <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap::pheatmap()</a></code> - it must be set to a
list with this format:</p></li>
</ul><p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">KnownGeneClass =</span> <span class="fu">c</span>(<span class="st">"OncoGene"</span> <span class="ot">=</span> color_spec,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Other"</span> <span class="ot">=</span> color_spec,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"TumSuppressor"</span> <span class="ot">=</span> color_spec),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ClinicalRelevance =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> color_spec,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"FALSE"</span> <span class="ot">=</span> color_spec),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">CriticalForInsMut =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> color_spec,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"FALSE"</span> <span class="ot">=</span> color_spec)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre><p></p></div>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Plotting functions: 
<code><a href="CIS_volcano_plot.html">CIS_volcano_plot</a>()</code>,
<code><a href="HSC_population_plot.html">HSC_population_plot</a>()</code>,
<code><a href="circos_genomic_density.html">circos_genomic_density</a>()</code>,
<code><a href="fisher_scatterplot.html">fisher_scatterplot</a>()</code>,
<code><a href="integration_alluvial_plot.html">integration_alluvial_plot</a>()</code>,
<code><a href="sharing_heatmap.html">sharing_heatmap</a>()</code>,
<code><a href="sharing_venn.html">sharing_venn</a>()</code>,
<code><a href="top_abund_tableGrob.html">top_abund_tableGrob</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"integration_matrices"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"association_file"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aggreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate_values_by_key.html">aggregate_values_by_key</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">integration_matrices</span>,</span></span>
<span class="r-in"><span>    association_file <span class="op">=</span> <span class="va">association_file</span>,</span></span>
<span class="r-in"><span>    value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cis_overtime</span> <span class="op">&lt;-</span> <span class="fu"><a href="CIS_grubbs_overtime.html">CIS_grubbs_overtime</a></span><span class="op">(</span><span class="va">aggreg</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Warning: missing genes in refgenes table</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> A total of 5 genes were found in the input data but not in the refgene table. This may be caused by a mismatch in the annotation phase of the matrix. Here is a summary: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 5 × 3</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   chr   GeneName  GeneStrand</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 14    PLEKHG4B  -         </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 15    CRELD2    -         </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 16    UBE2D2    +         </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 19    LINC01133 +         </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 6     HTR4      +         </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> NOTE: missing genes will be removed from the final output! Review results carefully</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> A total of 25 IS will be removed because of missing genes ( 2.33 % of total IS in input)</span>
<span class="r-in"><span><span class="va">hmaps</span> <span class="op">&lt;-</span> <span class="fu">top_cis_overtime_heatmap</span><span class="op">(</span><span class="va">cis_overtime</span><span class="op">$</span><span class="va">cis</span>,</span></span>
<span class="r-in"><span>    fill_NA_in_heatmap <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading annotated genes -  species selected: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Homo sapiens (Human)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading annotated genes -  done</span>
<span class="r-plt img"><img src="top_cis_overtime_heatmap-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="top_cis_overtime_heatmap-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To re-plot:</span></span></span>
<span class="r-in"><span><span class="co"># grid::grid.newpage()</span></span></span>
<span class="r-in"><span><span class="co"># grid::grid.draw(hmaps$PT001$gtable)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Andrea Calabria, Giulio Spinozzi, Giulia Pais.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>


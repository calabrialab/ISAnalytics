<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
Hematopoietic stem cells population size estimate with capture-recapture
models."><title>Hematopoietic stem cells population size estimate. — HSC_population_size_estimate • ISAnalytics</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hematopoietic stem cells population size estimate. — HSC_population_size_estimate"><meta property="og:description" content="
Hematopoietic stem cells population size estimate with capture-recapture
models."><meta property="og:image" content="https://calabrialab.github.io/ISAnalytics/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ISAnalytics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.8.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/ISAnalytics.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/workflow_start.html">Setting up the workflow and first steps</a>
    <a class="dropdown-item" href="../articles/sharing_analyses.html">Sharing analyses with ISAnalytics</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="https://calabrialab.github.io/ISAnalytics/dev/">
    <span class="fas fa fas fa-code-branch"></span>
     
    DEVEL
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/calabrialab/ISAnalytics/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Hematopoietic stem cells population size estimate.</h1>
      <small class="dont-index">Source: <a href="https://github.com/calabrialab/ISAnalytics/blob/HEAD/R/population-size-estimate.R" class="external-link"><code>R/population-size-estimate.R</code></a></small>
      <div class="d-none name"><code>HSC_population_size_estimate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a>
Hematopoietic stem cells population size estimate with capture-recapture
models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">HSC_population_size_estimate</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">metadata</span>,</span>
<span>  stable_timepoints <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aggregation_key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SubjectID"</span>, <span class="st">"CellMarker"</span>, <span class="st">"Tissue"</span>, <span class="st">"TimePoint"</span><span class="op">)</span>,</span>
<span>  blood_lineages <span class="op">=</span> <span class="fu"><a href="blood_lineages_default.html">blood_lineages_default</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  timepoint_column <span class="op">=</span> <span class="st">"TimePoint"</span>,</span>
<span>  seqCount_column <span class="op">=</span> <span class="st">"seqCount_sum"</span>,</span>
<span>  fragmentEstimate_column <span class="op">=</span> <span class="st">"fragmentEstimate_sum"</span>,</span>
<span>  seqCount_threshold <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  fragmentEstimate_threshold <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  nIS_threshold <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  cell_type <span class="op">=</span> <span class="st">"MYELOID"</span>,</span>
<span>  tissue_type <span class="op">=</span> <span class="st">"PB"</span>,</span>
<span>  max_workers <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>An aggregated integration matrix. See details.</p></dd>


<dt>metadata</dt>
<dd><p>An aggregated association file. See details.</p></dd>


<dt>stable_timepoints</dt>
<dd><p>A numeric vector or NULL if there are no
stable time points.</p></dd>


<dt>aggregation_key</dt>
<dd><p>A character vector indicating the key used for
aggregating x and metadata. Note that x and metadata should always be
aggregated with the same key.</p></dd>


<dt>blood_lineages</dt>
<dd><p>A data frame containing information on the blood
lineages. Users can supply their own, provided the columns <code>CellMarker</code> and
<code>CellType</code> are present.</p></dd>


<dt>timepoint_column</dt>
<dd><p>What is the name of the time point column to use?
Note that this column must be present in the key.</p></dd>


<dt>seqCount_column</dt>
<dd><p>What is the name of the column in x containing the
values of sequence count quantification?</p></dd>


<dt>fragmentEstimate_column</dt>
<dd><p>What is the name of the column in x
containing the values of fragment estimate quantification? If fragment
estimate is not present in the matrix, param should be set to <code>NULL</code>.</p></dd>


<dt>seqCount_threshold</dt>
<dd><p>A single numeric value. After re-aggregating <code>x</code>,
rows with a value greater or equal will be kept, the others will be
discarded.</p></dd>


<dt>fragmentEstimate_threshold</dt>
<dd><p>A single numeric value. Threshold
value for fragment estimate, see details.</p></dd>


<dt>nIS_threshold</dt>
<dd><p>A single numeric value. If a group (row) in the
metadata data frame has a count of distinct integration sites strictly
greater than this number it will be kept, otherwise discarded.</p></dd>


<dt>cell_type</dt>
<dd><p>The cell types to include in the models. Note that
the matching is case-insensitive.</p></dd>


<dt>tissue_type</dt>
<dd><p>The tissue types to include in the models. Note that
the matching is case-insensitive.</p></dd>


<dt>max_workers</dt>
<dd><p>Maximum parallel workers allowed</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data frame with the results of the estimates</p>
    </div>
    <div class="section level2">
    <h2 id="input-formats">Input formats<a class="anchor" aria-label="anchor" href="#input-formats"></a></h2>
    <p>Both <code>x</code> and <code>metadata</code> should be supplied to the function in aggregated
format (ideally through the use of <code><a href="aggregate_metadata.html">aggregate_metadata</a></code>
and <code><a href="aggregate_values_by_key.html">aggregate_values_by_key</a></code>).
Note that the <code>aggregation_key</code>, aka the vector of column names used for
aggregation, must contain at least the columns associated with the tags
<code>subject</code>, <code>cell_marker</code>, <code>tissue</code> and a time point column
(the user can specify the name of the
column in the argument <code>timepoint_column</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="on-time-points">On time points<a class="anchor" aria-label="anchor" href="#on-time-points"></a></h2>
    <p>If <code>stable_timepoints</code> is a vector with length &gt; 1, the function will look
for the first available stable time point and slice the data from that
time point onward. If <code>NULL</code> is supplied instead, it means there are no
stable time points available. Note that 0 time points are ALWAYS discarded.
Also, to be included in the analysis, a group must have at least 2
distinct non-zero time points.</p>
    </div>
    <div class="section level2">
    <h2 id="setting-a-threshold-for-fragment-estimate">Setting a threshold for fragment estimate<a class="anchor" aria-label="anchor" href="#setting-a-threshold-for-fragment-estimate"></a></h2>
    <p>If fragment estimate is present in the input matrix, the filtering logic
changes slightly: rows in the original matrix are kept if the sequence
count value is greater or equal than the <code>seqCount_threshold</code> AND
the fragment estimate value is greater or equal to the
<code>fragmentEstimate_threshold</code> IF PRESENT (non-zero value).
This means that for rows that miss fragment estimate, the filtering logic
will be applied only on sequence count. If the user wishes not to use
the combined filtering with fragment estimate, simply set
<code>fragmentEstimate_threshold = 0</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="required-tags">Required tags<a class="anchor" aria-label="anchor" href="#required-tags"></a></h2>
    

<p>The function will explicitly check for the presence of these tags:</p><ul><li><p>subject</p></li>
<li><p>tissue</p></li>
<li><p>cell_marker</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Analysis functions: 
<code><a href="CIS_grubbs.html">CIS_grubbs</a>()</code>,
<code><a href="compute_abundance.html">compute_abundance</a>()</code>,
<code><a href="cumulative_is.html">cumulative_is</a>()</code>,
<code><a href="gene_frequency_fisher.html">gene_frequency_fisher</a>()</code>,
<code><a href="is_sharing.html">is_sharing</a>()</code>,
<code><a href="iss_source.html">iss_source</a>()</code>,
<code><a href="sample_statistics.html">sample_statistics</a>()</code>,
<code><a href="top_integrations.html">top_integrations</a>()</code>,
<code><a href="top_targeted_genes.html">top_targeted_genes</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"integration_matrices"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"association_file"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aggreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate_values_by_key.html">aggregate_values_by_key</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">integration_matrices</span>,</span></span>
<span class="r-in"><span>    association_file <span class="op">=</span> <span class="va">association_file</span>,</span></span>
<span class="r-in"><span>    value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aggreg_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate_metadata.html">aggregate_metadata</a></span><span class="op">(</span>association_file <span class="op">=</span> <span class="va">association_file</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">estimate</span> <span class="op">&lt;-</span> <span class="fu">HSC_population_size_estimate</span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">aggreg</span>,</span></span>
<span class="r-in"><span>    metadata <span class="op">=</span> <span class="va">aggreg_meta</span>,</span></span>
<span class="r-in"><span>    fragmentEstimate_column <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    stable_timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">180</span>, <span class="fl">360</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    cell_type <span class="op">=</span> <span class="st">"Other"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating number of IS for each group...</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Andrea Calabria, Giulio Spinozzi, Giulia Pais.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>


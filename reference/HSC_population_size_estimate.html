<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Hematopoietic stem cells population size estimate. — HSC_population_size_estimate • ISAnalytics</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Hematopoietic stem cells population size estimate. — HSC_population_size_estimate" />
<meta property="og:description" content="

Hematopoietic stem cells population size estimate with capture-recapture
models." />
<meta property="og:image" content="https://calabrialab.github.io/ISAnalytics/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ISAnalytics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/aggregate_function_usage.html">Working with aggregate functions</a>
    </li>
    <li>
      <a href="../articles/collision_removal.html">Collision removal functionality</a>
    </li>
    <li>
      <a href="../articles/how_to_import_functions.html">How to use import functions</a>
    </li>
    <li>
      <a href="../articles/sharing_analyses.html">Sharing analyses with ISAnalytics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://calabrialab.github.io/ISAnalytics/dev/">
    <span class="fas fa-code-branch"></span>
     
    DEVEL
  </a>
</li>
<li>
  <a href="https://github.com/calabrialab/ISAnalytics/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Hematopoietic stem cells population size estimate.</h1>
    <small class="dont-index">Source: <a href='https://github.com/calabrialab/ISAnalytics/blob/master/R/population-size-estimate.R'><code>R/population-size-estimate.R</code></a></small>
    <div class="hidden name"><code>HSC_population_size_estimate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href='https://lifecycle.r-lib.org/articles/stages.html#experimental'><img src='figures/lifecycle-experimental.svg' alt='[Experimental]' /></a>

Hematopoietic stem cells population size estimate with capture-recapture
models.</p>
    </div>

    <pre class="usage"><span class='fu'>HSC_population_size_estimate</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>metadata</span>,
  stable_timepoints <span class='op'>=</span> <span class='cn'>NULL</span>,
  aggregation_key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SubjectID"</span>, <span class='st'>"CellMarker"</span>, <span class='st'>"Tissue"</span>, <span class='st'>"TimePoint"</span><span class='op'>)</span>,
  blood_lineages <span class='op'>=</span> <span class='fu'><a href='blood_lineages_default.html'>blood_lineages_default</a></span><span class='op'>(</span><span class='op'>)</span>,
  timepoint_column <span class='op'>=</span> <span class='st'>"TimePoint"</span>,
  seqCount_column <span class='op'>=</span> <span class='st'>"seqCount_sum"</span>,
  seqCount_threshold <span class='op'>=</span> <span class='fl'>3</span>,
  nIS_threshold <span class='op'>=</span> <span class='fl'>5</span>,
  cell_type <span class='op'>=</span> <span class='st'>"MYELOID"</span>,
  tissue_type <span class='op'>=</span> <span class='st'>"PB"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An aggregated integration matrix. See details.</p></td>
    </tr>
    <tr>
      <th>metadata</th>
      <td><p>An aggregated association file. See details.</p></td>
    </tr>
    <tr>
      <th>stable_timepoints</th>
      <td><p>A numeric vector or NULL if there are no
stable time points.</p></td>
    </tr>
    <tr>
      <th>aggregation_key</th>
      <td><p>A character vector indicating the key used for
aggregating x and metadata. Note that x and metadata should always be
aggregated with the same key.</p></td>
    </tr>
    <tr>
      <th>blood_lineages</th>
      <td><p>A data frame containing information on the blood
lineages. Users can supply their own, provided the columns <code>CellMarker</code> and
<code>CellType</code> are present.</p></td>
    </tr>
    <tr>
      <th>timepoint_column</th>
      <td><p>What is the name of the time point column to use?
Note that this column must be present in the key.</p></td>
    </tr>
    <tr>
      <th>seqCount_column</th>
      <td><p>What is the name of the column in x holding the
values of sequence count quantification?</p></td>
    </tr>
    <tr>
      <th>seqCount_threshold</th>
      <td><p>A single numeric value. After re-aggregating <code>x</code>,
rows with a value greater or equal will be kept, the others will be
discarded.</p></td>
    </tr>
    <tr>
      <th>nIS_threshold</th>
      <td><p>A single numeric value. If a group (row) in the
metadata data frame has a count of distinct integration sites strictly
greater than this number it will be kept, otherwise discarded.</p></td>
    </tr>
    <tr>
      <th>cell_type</th>
      <td><p>The cell types to include in the models. Note that
the matching is case-insensitive.</p></td>
    </tr>
    <tr>
      <th>tissue_type</th>
      <td><p>The tissue types to include in the models. Note that
the matching is case-insensitive.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame with the results of the estimates</p>
    <h2 class="hasAnchor" id="input-formats"><a class="anchor" href="#input-formats"></a>Input formats</h2>

    <p>Both <code>x</code> and <code>metadata</code> should be supplied to the function in aggregated
format (ideally through the use of <code><a href='aggregate_metadata.html'>aggregate_metadata</a></code>
and <code><a href='aggregate_values_by_key.html'>aggregate_values_by_key</a></code>).
Note that the <code>aggregation_key</code>, aka the vector of column names used for
aggregation, must contain at least the columns SubjectID, CellMarker,
Tissue and a time point column (the user can specify the name of the
column in the argument <code>timepoint_column</code>).</p>
    <h2 class="hasAnchor" id="on-time-points"><a class="anchor" href="#on-time-points"></a>On time points</h2>

    <p>If <code>stable_timepoints</code> is a vector with length &gt; 1, the function will look
for the first available stable time point and slice the data from that
time point onward. If NULL is supplied instead, it means there are no
stable time points available. Note that 0 time points are ALWAYS discarded.
Also, to be included in the analysis, a group must have at least 2
distinct non-zero time points.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"integration_matrices"</span>, package <span class='op'>=</span> <span class='st'>"ISAnalytics"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"association_file"</span>, package <span class='op'>=</span> <span class='st'>"ISAnalytics"</span><span class='op'>)</span>
<span class='va'>aggreg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='aggregate_values_by_key.html'>aggregate_values_by_key</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>integration_matrices</span>,
    association_file <span class='op'>=</span> <span class='va'>association_file</span>,
    value_cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"seqCount"</span>, <span class='st'>"fragmentEstimate"</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>aggreg_meta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='aggregate_metadata.html'>aggregate_metadata</a></span><span class='op'>(</span>association_file <span class='op'>=</span> <span class='va'>association_file</span><span class='op'>)</span>
<span class='va'>estimate</span> <span class='op'>&lt;-</span> <span class='fu'>HSC_population_size_estimate</span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>aggreg</span>,
    metadata <span class='op'>=</span> <span class='va'>aggreg_meta</span>,
    stable_timepoints <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>90</span>, <span class='fl'>180</span>, <span class='fl'>360</span><span class='op'>)</span>,
    cell_type <span class='op'>=</span> <span class='st'>"Other"</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Calculating number of IS for each group...</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andrea Calabria, Giulio Spinozzi, Giulia Pais.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



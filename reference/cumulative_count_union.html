<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Integrations cumulative count in time by sample — cumulative_count_union • ISAnalytics</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Integrations cumulative count in time by sample — cumulative_count_union" />
<meta property="og:description" content="

This function computes the cumulative number of integrations
observed in each sample at different time points by assuming that
if an integration is observed at time point &quot;t&quot; then it is also observed in
time point &quot;t+1&quot;." />
<meta property="og:image" content="https://calabrialab.github.io/ISAnalytics/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ISAnalytics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/aggregate_function_usage.html">Working with aggregate functions</a>
    </li>
    <li>
      <a href="../articles/collision_removal.html">Collision removal functionality</a>
    </li>
    <li>
      <a href="../articles/how_to_import_functions.html">How to use import functions</a>
    </li>
    <li>
      <a href="../articles/sharing_analyses.html">Sharing analyses with ISAnalytics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://calabrialab.github.io/ISAnalytics/dev/">
    <span class="fas fa-code-branch"></span>
     
    DEVEL
  </a>
</li>
<li>
  <a href="https://github.com/calabrialab/ISAnalytics/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Integrations cumulative count in time by sample</h1>
    <small class="dont-index">Source: <a href='https://github.com/calabrialab/ISAnalytics/blob/master/R/analysis-functions.R'><code>R/analysis-functions.R</code></a></small>
    <div class="hidden name"><code>cumulative_count_union.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href='https://lifecycle.r-lib.org/articles/stages.html#experimental'><img src='figures/lifecycle-experimental.svg' alt='[Experimental]' /></a>

This function computes the cumulative number of integrations
observed in each sample at different time points by assuming that
if an integration is observed at time point "t" then it is also observed in
time point "t+1".</p>
    </div>

    <pre class="usage"><span class='fu'>cumulative_count_union</span><span class='op'>(</span>
  <span class='va'>x</span>,
  association_file <span class='op'>=</span> <span class='cn'>NULL</span>,
  timepoint_column <span class='op'>=</span> <span class='st'>"TimePoint"</span>,
  key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SubjectID"</span>, <span class='st'>"CellMarker"</span>, <span class='st'>"Tissue"</span>, <span class='st'>"TimePoint"</span><span class='op'>)</span>,
  include_tp_zero <span class='op'>=</span> <span class='cn'>FALSE</span>,
  zero <span class='op'>=</span> <span class='st'>"0000"</span>,
  aggregate <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A simple integration matrix or an aggregated matrix (see details)</p></td>
    </tr>
    <tr>
      <th>association_file</th>
      <td><p>NULL or the association file for x if <code>aggregate</code>
is set to TRUE</p></td>
    </tr>
    <tr>
      <th>timepoint_column</th>
      <td><p>What is the name of the time point column?</p></td>
    </tr>
    <tr>
      <th>key</th>
      <td><p>The aggregation key - must always contain the <code>timepoint_column</code></p></td>
    </tr>
    <tr>
      <th>include_tp_zero</th>
      <td><p>Include timepoint 0?</p></td>
    </tr>
    <tr>
      <th>zero</th>
      <td><p>How is 0 coded in the data frame?</p></td>
    </tr>
    <tr>
      <th>aggregate</th>
      <td><p>Should x be aggregated?</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters to pass to <code>aggregate_values_by_key</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Input data frame</h3>


<p>The user can provide as input for the <code>x</code> parameter both a simple
integration matrix AND setting the <code>aggregate</code> parameter to TRUE,
or provide an already aggregated matrix via
<a href='aggregate_values_by_key.html'>aggregate_values_by_key</a>.
If the user supplies a matrix to be aggregated the <code>association_file</code>
parameter must not be NULL: aggregation will be done by an internal
call to the aggregation function.
If the user supplies an already aggregated matrix, the <code>key</code> parameter
is the key used for aggregation -
<strong>NOTE: for this operation is mandatory
that the time point column is included in the key.</strong></p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Assumptions on time point format</h3>


<p>By using the functions provided by this package, when imported,
an association file will be correctly formatted for future usage.
In the formatting process there is also a padding operation performed on
time points: this means the functions expects the time point column to
be of type character and to be correctly padded with 0s. If the
chosen column for time point is detected as numeric the function will
attempt the conversion to character and automatic padding.
If you choose to import the association file not using the
<a href='import_association_file.html'>import_association_file</a> function, be sure to check the format of
the chosen column to avoid undesired results.</p>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other Analysis functions: 
<code><a href='CIS_grubbs.html'>CIS_grubbs</a>()</code>,
<code><a href='comparison_matrix.html'>comparison_matrix</a>()</code>,
<code><a href='compute_abundance.html'>compute_abundance</a>()</code>,
<code><a href='cumulative_is.html'>cumulative_is</a>()</code>,
<code><a href='is_sharing.html'>is_sharing</a>()</code>,
<code><a href='iss_source.html'>iss_source</a>()</code>,
<code><a href='purity_filter.html'>purity_filter</a>()</code>,
<code><a href='sample_statistics.html'>sample_statistics</a>()</code>,
<code><a href='separate_quant_matrices.html'>separate_quant_matrices</a>()</code>,
<code><a href='threshold_filter.html'>threshold_filter</a>()</code>,
<code><a href='top_integrations.html'>top_integrations</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"integration_matrices"</span>, package <span class='op'>=</span> <span class='st'>"ISAnalytics"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"association_file"</span>, package <span class='op'>=</span> <span class='st'>"ISAnalytics"</span><span class='op'>)</span>
<span class='va'>aggreg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='aggregate_values_by_key.html'>aggregate_values_by_key</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>integration_matrices</span>,
    association_file <span class='op'>=</span> <span class='va'>association_file</span>,
    value_cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"seqCount"</span>, <span class='st'>"fragmentEstimate"</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>cumulative_count</span> <span class='op'>&lt;-</span> <span class='fu'>cumulative_count_union</span><span class='op'>(</span><span class='va'>aggreg</span><span class='op'>)</span>
<span class='va'>cumulative_count</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 20 × 5</span>
#&gt;    SubjectID CellMarker Tissue TimePoint count
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>     <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>      <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>     <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span>
#&gt; <span style='color: #BCBCBC;'> 1</span> PT001     MNC        BM     0030         54
#&gt; <span style='color: #BCBCBC;'> 2</span> PT001     MNC        BM     0060        147
#&gt; <span style='color: #BCBCBC;'> 3</span> PT001     MNC        BM     0090        179
#&gt; <span style='color: #BCBCBC;'> 4</span> PT001     MNC        BM     0180        240
#&gt; <span style='color: #BCBCBC;'> 5</span> PT001     MNC        BM     0360        240
#&gt; <span style='color: #BCBCBC;'> 6</span> PT001     MNC        PB     0030         28
#&gt; <span style='color: #BCBCBC;'> 7</span> PT001     MNC        PB     0060         77
#&gt; <span style='color: #BCBCBC;'> 8</span> PT001     MNC        PB     0090        104
#&gt; <span style='color: #BCBCBC;'> 9</span> PT001     MNC        PB     0180        121
#&gt; <span style='color: #BCBCBC;'>10</span> PT001     MNC        PB     0360        121
#&gt; <span style='color: #BCBCBC;'>11</span> PT002     MNC        BM     0030         98
#&gt; <span style='color: #BCBCBC;'>12</span> PT002     MNC        BM     0060        126
#&gt; <span style='color: #BCBCBC;'>13</span> PT002     MNC        BM     0090        141
#&gt; <span style='color: #BCBCBC;'>14</span> PT002     MNC        BM     0180        184
#&gt; <span style='color: #BCBCBC;'>15</span> PT002     MNC        BM     0360        265
#&gt; <span style='color: #BCBCBC;'>16</span> PT002     MNC        PB     0030         15
#&gt; <span style='color: #BCBCBC;'>17</span> PT002     MNC        PB     0060         26
#&gt; <span style='color: #BCBCBC;'>18</span> PT002     MNC        PB     0090         38
#&gt; <span style='color: #BCBCBC;'>19</span> PT002     MNC        PB     0180         62
#&gt; <span style='color: #BCBCBC;'>20</span> PT002     MNC        PB     0360        109</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andrea Calabria, Giulio Spinozzi, Giulia Pais.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



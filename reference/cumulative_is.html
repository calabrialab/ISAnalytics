<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='
Given an input integration matrix that can be grouped over time,
this function adds integrations in groups assuming that
if an integration is observed at time point "t" then it is also observed in
time point "t+1".'><title>Expands integration matrix with the cumulative IS union over time. — cumulative_is • ISAnalytics</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Expands integration matrix with the cumulative IS union over time. — cumulative_is"><meta property="og:description" content='
Given an input integration matrix that can be grouped over time,
this function adds integrations in groups assuming that
if an integration is observed at time point "t" then it is also observed in
time point "t+1".'><meta property="og:image" content="https://calabrialab.github.io/ISAnalytics/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ISAnalytics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.6.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/ISAnalytics.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/workflow_start.html">Setting up the workflow and first steps</a>
    <a class="dropdown-item" href="../articles/sharing_analyses.html">Sharing analyses with ISAnalytics</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="https://calabrialab.github.io/ISAnalytics/dev">
    <span class="fas fa fas fa-code-branch"></span>
     
    DEVEL
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/calabrialab/ISAnalytics/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Expands integration matrix with the cumulative IS union over time.</h1>
      <small class="dont-index">Source: <a href="https://github.com/calabrialab/ISAnalytics/blob/HEAD/R/analysis-functions.R" class="external-link"><code>R/analysis-functions.R</code></a></small>
      <div class="d-none name"><code>cumulative_is.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
Given an input integration matrix that can be grouped over time,
this function adds integrations in groups assuming that
if an integration is observed at time point "t" then it is also observed in
time point "t+1".</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">cumulative_is</span><span class="op">(</span>
  <span class="va">x</span>,
  key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SubjectID"</span>, <span class="st">"CellMarker"</span>, <span class="st">"Tissue"</span>, <span class="st">"TimePoint"</span><span class="op">)</span>,
  timepoint_col <span class="op">=</span> <span class="st">"TimePoint"</span>,
  include_tp_zero <span class="op">=</span> <span class="cn">FALSE</span>,
  counts <span class="op">=</span> <span class="cn">TRUE</span>,
  keep_og_is <span class="op">=</span> <span class="cn">FALSE</span>,
  expand <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>An integration matrix, ideally aggregated via
<code><a href="aggregate_values_by_key.html">aggregate_values_by_key()</a></code></p></dd>
<dt>key</dt>
<dd><p>The aggregation key used</p></dd>
<dt>timepoint_col</dt>
<dd><p>The name of the time point column</p></dd>
<dt>include_tp_zero</dt>
<dd><p>Should time point 0 be included?</p></dd>
<dt>counts</dt>
<dd><p>Add cumulative counts? Logical</p></dd>
<dt>keep_og_is</dt>
<dd><p>Keep original set of integrations as a separate column?</p></dd>
<dt>expand</dt>
<dd><p>If <code>FALSE</code>, for each group, the set of integration sites is
returned in a separate column as a nested table, otherwise the resulting
column is unnested.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame</p>
    </div>
    <div class="section level2">
    <h2 id="required-tags">Required tags<a class="anchor" aria-label="anchor" href="#required-tags"></a></h2>
    

<p>The function will explicitly check for the presence of these tags:</p><ul><li><p>All columns declared in <code><a href="mandatory_IS_vars.html">mandatory_IS_vars()</a></code></p></li>
<li><p>Checks if the matrix is annotated by assessing presence of
<code><a href="mandatory_IS_vars.html">annotation_IS_vars()</a></code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Analysis functions: 
<code><a href="CIS_grubbs.html">CIS_grubbs</a>()</code>,
<code><a href="HSC_population_size_estimate.html">HSC_population_size_estimate</a>()</code>,
<code><a href="compute_abundance.html">compute_abundance</a>()</code>,
<code><a href="gene_frequency_fisher.html">gene_frequency_fisher</a>()</code>,
<code><a href="is_sharing.html">is_sharing</a>()</code>,
<code><a href="iss_source.html">iss_source</a>()</code>,
<code><a href="sample_statistics.html">sample_statistics</a>()</code>,
<code><a href="top_integrations.html">top_integrations</a>()</code>,
<code><a href="top_targeted_genes.html">top_targeted_genes</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"integration_matrices"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"association_file"</span>, package <span class="op">=</span> <span class="st">"ISAnalytics"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">aggreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate_values_by_key.html">aggregate_values_by_key</a></span><span class="op">(</span></span>
<span class="r-in">    x <span class="op">=</span> <span class="va">integration_matrices</span>,</span>
<span class="r-in">    association_file <span class="op">=</span> <span class="va">association_file</span>,</span>
<span class="r-in">    value_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"seqCount"</span>, <span class="st">"fragmentEstimate"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">cumulated_is</span> <span class="op">&lt;-</span> <span class="fu">cumulative_is</span><span class="op">(</span><span class="va">aggreg</span><span class="op">)</span></span>
<span class="r-in"><span class="va">cumulated_is</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $coordinates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       SubjectID CellMarker Tissue TimePoint chr integration_locus strand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:     PT001        MNC     BM        30   1           8464757      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:     PT001        MNC     BM        30   1          16186297      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:     PT001        MNC     BM        30   1          40689188      +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:     PT001        MNC     BM        30   1         157759338      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:     PT001        MNC     BM        30   1         234596545      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2371:     PT002        MNC     PB       360   5         176653985      +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2372:     PT002        MNC     PB       360   6         147673451      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2373:     PT002        MNC     PB       360   7           5039809      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2374:     PT002        MNC     PB       360   7          17227687      +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2375:     PT002        MNC     PB       360   9         127351995      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       GeneName GeneStrand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:     RERE          -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:     SPEN          +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:      RLF          +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:    FCRL1          -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:   TARBP1          -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2371:     NSD1          +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2372:   STXBP5          +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2373: RNF216P1          +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2374:      AHR          +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2375:    NR6A1          -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $counts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     SubjectID CellMarker Tissue TimePoint is_n_cumulative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:     PT001        MNC     BM        30              54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:     PT001        MNC     BM        60             147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:     PT001        MNC     BM        90             179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     PT001        MNC     BM       180             240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:     PT001        MNC     BM       360             240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     PT001        MNC     PB        30              28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:     PT001        MNC     PB        60              77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:     PT001        MNC     PB        90             104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     PT001        MNC     PB       180             121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:     PT001        MNC     PB       360             121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:     PT002        MNC     BM        30              98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:     PT002        MNC     BM        60             126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:     PT002        MNC     BM        90             141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:     PT002        MNC     BM       180             184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:     PT002        MNC     BM       360             265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:     PT002        MNC     PB        30              15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:     PT002        MNC     PB        60              26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:     PT002        MNC     PB        90              38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:     PT002        MNC     PB       180              62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:     PT002        MNC     PB       360             109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Andrea Calabria, Giulio Spinozzi, Giulia Pais.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

